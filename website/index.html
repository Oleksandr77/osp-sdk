<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Open Skills Protocol — The Open Standard for AI Skill Routing</title>
  <meta name="description"
    content="OSP is the vendor-neutral open standard for packaging, routing, and safely executing skills in multi-persona AI systems. Real BM25, real embeddings, real cryptographic signing.">
  <meta name="keywords" content="Open Skills Protocol, OSP, AI routing, skill routing, AI safety, AMADEQ, ASP">
  <meta property="og:title" content="Open Skills Protocol — AI Skill Routing Standard">
  <meta property="og:description"
    content="The vendor-neutral standard for packaging, routing, and safely executing skills in multi-persona AI systems.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://amadeq.org">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Open Skills Protocol">
  <meta name="twitter:description"
    content="The open standard for AI skill routing. BM25 + embeddings + cryptographic signing.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link
    href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500;600&family=Bebas+Neue&family=Barlow:wght@300;400;500;600;700;900&display=swap"
    rel="stylesheet">
  <style>
    :root {
      --bg: #080b0f;
      --bg2: #0d1117;
      --bg3: #111820;
      --border: rgba(255, 200, 50, 0.10);
      --border2: rgba(255, 200, 50, 0.25);
      --amber: #ffc832;
      --amber-dim: rgba(255, 200, 50, 0.15);
      --amber-glow: rgba(255, 200, 50, 0.06);
      --green: #39ff88;
      --green-dim: rgba(57, 255, 136, 0.12);
      --red: #ff4d6a;
      --red-dim: rgba(255, 77, 106, 0.12);
      --blue: #38bdf8;
      --blue-dim: rgba(56, 189, 248, 0.12);
      --text: #e8ecf2;
      --muted: #7a8499;
      --dim: #2e3647;
      --mono: 'IBM Plex Mono', monospace;
      --display: 'Bebas Neue', cursive;
      --body: 'Barlow', sans-serif;
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0
    }

    html {
      scroll-behavior: smooth
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--body);
      font-size: 15px;
      line-height: 1.65;
      overflow-x: hidden;
      animation: pageEnter 0.8s ease-out;
    }

    @keyframes pageEnter {
      from {
        opacity: 0;
        transform: translateY(12px);
      }

      to {
        opacity: 1;
        transform: none;
      }
    }

    /* SCANLINE OVERLAY */
    body::after {
      content: '';
      position: fixed;
      inset: 0;
      background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0, 0, 0, 0.03) 2px, rgba(0, 0, 0, 0.03) 4px);
      pointer-events: none;
      z-index: 9999;
    }

    /* GRID BG */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(rgba(255, 200, 50, 0.025) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 200, 50, 0.025) 1px, transparent 1px);
      background-size: 40px 40px;
      pointer-events: none;
      z-index: 0;
    }

    section,
    nav,
    footer {
      position: relative;
      z-index: 1
    }

    /* ── NAV ── */
    nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 48px;
      background: rgba(8, 11, 15, 0.85);
      backdrop-filter: blur(16px);
      border-bottom: 1px solid var(--border);
      transition: background 0.3s, box-shadow 0.3s;
    }

    nav.scrolled {
      background: rgba(8, 11, 15, 0.97);
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.4);
    }

    .nav-links a.active {
      color: var(--amber) !important;
    }

    .nav-logo {
      display: flex;
      align-items: center;
      gap: 12px
    }

    .osp-mark {
      font-family: var(--mono);
      font-size: 13px;
      font-weight: 600;
      color: var(--bg);
      background: var(--amber);
      padding: 3px 8px;
      border-radius: 2px;
      letter-spacing: 0.04em;
    }

    .nav-title {
      font-family: var(--mono);
      font-size: 13px;
      color: var(--muted);
      letter-spacing: 0.04em
    }

    .nav-title span {
      color: var(--text)
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 28px;
      list-style: none
    }

    .nav-links a {
      font-family: var(--mono);
      font-size: 12px;
      color: var(--muted);
      text-decoration: none;
      letter-spacing: 0.04em;
      transition: color 0.2s;
    }

    .nav-links a:hover {
      color: var(--amber)
    }

    .nav-cta {
      font-family: var(--mono) !important;
      font-size: 12px !important;
      color: var(--amber) !important;
      border: 1px solid var(--border2) !important;
      padding: 6px 16px !important;
      border-radius: 2px !important;
      transition: all 0.2s !important;
    }

    .nav-cta:hover {
      background: var(--amber-dim) !important
    }

    .nav-status {
      display: flex;
      align-items: center;
      gap: 6px;
      font-family: var(--mono);
      font-size: 11px;
      color: var(--green);
      background: var(--green-dim);
      border: 1px solid rgba(57, 255, 136, 0.2);
      padding: 3px 10px;
      border-radius: 2px;
    }

    .pulse {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--green);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1
      }

      50% {
        opacity: 0.3
      }
    }

    /* ── HERO ── */
    #hero {
      min-height: 100vh;
      display: flex;
      align-items: center;
      padding: 100px 0 60px;
      overflow: hidden;
    }

    .hero-inner {
      max-width: 1160px;
      margin: 0 auto;
      padding: 0 48px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 64px;
      align-items: center;
    }

    .hero-left {}

    .hero-tag {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      background: var(--bg2);
      border: 1px solid var(--border);
      padding: 5px 12px;
      border-radius: 2px;
      margin-bottom: 28px;
    }

    .hero-tag .dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--amber)
    }

    h1 {
      font-family: var(--display);
      font-size: clamp(64px, 8vw, 110px);
      line-height: 0.95;
      letter-spacing: 0.02em;
      margin-bottom: 8px;
    }

    .h1-line1 {
      color: var(--text)
    }

    .h1-line2 {
      color: var(--amber)
    }

    .h1-line3 {
      color: transparent;
      -webkit-text-stroke: 1px rgba(255, 200, 50, 0.35);
    }

    .hero-sub {
      font-size: 17px;
      color: var(--muted);
      max-width: 480px;
      line-height: 1.7;
      margin: 28px 0 36px;
      font-weight: 300;
    }

    .hero-sub strong {
      color: var(--text);
      font-weight: 600
    }

    .hero-btns {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 48px
    }

    .btn-amber {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--amber);
      color: var(--bg);
      font-family: var(--mono);
      font-size: 13px;
      font-weight: 600;
      padding: 12px 24px;
      border-radius: 2px;
      text-decoration: none;
      border: none;
      cursor: pointer;
      letter-spacing: 0.04em;
      transition: all 0.2s;
    }

    .btn-amber:hover {
      background: #ffe066;
      transform: translateY(-1px)
    }

    .btn-ghost {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: transparent;
      color: var(--muted);
      font-family: var(--mono);
      font-size: 13px;
      font-weight: 400;
      padding: 12px 20px;
      border-radius: 2px;
      text-decoration: none;
      border: 1px solid var(--border);
      cursor: pointer;
      letter-spacing: 0.04em;
      transition: all 0.2s;
    }

    .btn-ghost:hover {
      border-color: var(--border2);
      color: var(--text)
    }

    /* INSTALL BLOCK */
    .install-block {
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
    }

    .install-tabs {
      display: flex;
      gap: 0;
      border-bottom: 1px solid var(--border);
    }

    .itab {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted);
      padding: 8px 16px;
      cursor: pointer;
      transition: all 0.2s;
      border-right: 1px solid var(--border);
      letter-spacing: 0.04em;
      background: transparent;
      border-top: none;
      border-left: none;
      border-bottom: 2px solid transparent;
    }

    .itab.active {
      color: var(--amber);
      border-bottom-color: var(--amber);
      background: var(--amber-glow)
    }

    .install-code {
      padding: 16px 20px;
      font-family: var(--mono);
      font-size: 12.5px;
      color: var(--text);
      line-height: 1.8;
      display: none;
    }

    .install-code.active {
      display: block
    }

    .ic-comment {
      color: var(--muted)
    }

    .ic-pkg {
      color: var(--amber)
    }

    .ic-flag {
      color: var(--green)
    }

    .ic-cmd {
      color: var(--blue)
    }

    /* HERO RIGHT — METRICS */
    .hero-right {}

    .metrics-vertical {
      display: flex;
      flex-direction: column;
      gap: 2px
    }

    .metric-row {
      background: var(--bg2);
      border: 1px solid var(--border);
      padding: 20px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: all 0.2s;
    }

    .metric-row:hover {
      border-color: var(--border2);
      background: var(--bg3)
    }

    .metric-row:first-child {
      border-radius: 4px 4px 0 0
    }

    .metric-row:last-child {
      border-radius: 0 0 4px 4px
    }

    .m-val {
      font-family: var(--display);
      font-size: 42px;
      line-height: 1;
      color: var(--text);
      letter-spacing: 0.02em;
    }

    .m-val .unit {
      font-family: var(--mono);
      font-size: 18px;
      color: var(--amber)
    }

    .m-label {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted);
      letter-spacing: 0.06em;
      max-width: 180px;
      text-align: right
    }

    .conformance-bar {
      background: var(--bg2);
      border: 1px solid var(--border);
      padding: 16px 20px;
      margin-top: 2px;
      border-radius: 0 0 4px 4px;
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .conf-progress {
      flex: 1;
      height: 4px;
      background: var(--dim);
      border-radius: 2px;
      overflow: hidden
    }

    .conf-fill {
      height: 100%;
      background: var(--green);
      width: 0;
      transition: width 1.5s ease 0.5s;
      border-radius: 2px
    }

    .conf-label {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--green);
      white-space: nowrap
    }

    /* ── CONTAINER ── */
    .container {
      max-width: 1160px;
      margin: 0 auto;
      padding: 0 48px
    }

    /* ── SECTION COMMON ── */
    .s-tag {
      display: inline-block;
      font-family: var(--mono);
      font-size: 10px;
      color: var(--amber);
      letter-spacing: 0.14em;
      text-transform: uppercase;
      background: var(--amber-dim);
      border: 1px solid rgba(255, 200, 50, 0.2);
      padding: 3px 10px;
      border-radius: 2px;
      margin-bottom: 16px;
    }

    h2 {
      font-family: var(--display);
      font-size: clamp(36px, 4vw, 56px);
      line-height: 1.05;
      letter-spacing: 0.02em;
      margin-bottom: 14px;
    }

    .s-desc {
      font-size: 15px;
      color: var(--muted);
      max-width: 560px;
      line-height: 1.7;
      font-weight: 300;
    }

    /* ── DIVIDER ── */
    .section-divider {
      border: none;
      height: 1px;
      margin: 0;
      background: linear-gradient(90deg, transparent, rgba(255, 200, 50, 0.2) 20%, rgba(57, 255, 136, 0.15) 50%, rgba(255, 200, 50, 0.2) 80%, transparent);
    }

    /* ── HERO SHIMMER ── */
    .h1-line2 {
      background: linear-gradient(90deg, var(--amber) 0%, #ffe066 40%, var(--amber) 80%);
      background-size: 200% auto;
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: shimmer 4s linear infinite;
    }

    @keyframes shimmer {
      to {
        background-position: 200% center;
      }
    }

    /* ── COPY TOOLTIP ── */
    .install-code {
      position: relative;
      cursor: pointer;
    }

    .copy-toast {
      position: absolute;
      top: 8px;
      right: 12px;
      font-family: var(--mono);
      font-size: 10px;
      color: var(--green);
      background: var(--green-dim);
      border: 1px solid rgba(57, 255, 136, 0.2);
      padding: 2px 8px;
      border-radius: 2px;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
    }

    .copy-toast.show {
      opacity: 1;
    }

    /* ── STAGGER DELAYS ── */
    .reveal-d1 {
      transition-delay: 0.1s;
    }

    .reveal-d2 {
      transition-delay: 0.2s;
    }

    .reveal-d3 {
      transition-delay: 0.3s;
    }

    .reveal-d4 {
      transition-delay: 0.4s;
    }

    /* ── CURSOR GLOW ── */
    .cursor-glow {
      position: fixed;
      width: 600px;
      height: 600px;
      border-radius: 50%;
      pointer-events: none;
      z-index: 0;
      background: radial-gradient(circle, rgba(255, 200, 50, 0.04) 0%, transparent 70%);
      transform: translate(-50%, -50%);
      transition: opacity 0.3s;
      opacity: 0;
    }

    .cursor-glow.active {
      opacity: 1;
    }

    /* ── PLAYGROUND PROGRESS ── */
    .run-btn {
      position: relative;
      overflow: hidden;
    }

    .run-progress {
      position: absolute;
      left: 0;
      bottom: 0;
      height: 3px;
      width: 0;
      background: linear-gradient(90deg, var(--green), var(--blue));
      transition: width 0.3s ease;
      border-radius: 0 0 2px 2px;
    }

    .run-btn.running {
      pointer-events: none;
      opacity: 0.85;
    }

    .run-btn.running .run-label {
      animation: btnPulse 1.2s ease infinite;
    }

    @keyframes btnPulse {

      0%,
      100% {
        opacity: 0.6;
      }

      50% {
        opacity: 1;
      }
    }

    /* ── TRACE EXPAND ── */
    .rc-trace-toggle {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--muted);
      cursor: pointer;
      background: var(--bg);
      border: 1px solid var(--border);
      padding: 4px 10px;
      border-radius: 2px;
      margin-top: 10px;
      display: inline-block;
      transition: color 0.2s;
    }

    .rc-trace-toggle:hover {
      color: var(--amber);
      border-color: var(--border2);
    }

    .rc-trace-body {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease, opacity 0.3s;
      opacity: 0;
      font-family: var(--mono);
      font-size: 10.5px;
      color: var(--dim);
      line-height: 1.8;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 2px;
      margin-top: 8px;
      padding: 0 12px;
    }

    .rc-trace-body.open {
      max-height: 300px;
      opacity: 1;
      padding: 12px;
    }

    .rc-trace-body .tk {
      color: var(--amber);
    }

    .rc-trace-body .tv {
      color: var(--green);
    }

    /* ── BRAND SPLIT ── */
    #brand-split {
      padding: 80px 0;
      background: var(--bg)
    }

    .brand-split-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2px;
      background: var(--border);
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 40px;
    }

    .brand-card {
      background: var(--bg2);
      padding: 40px;
      position: relative;
      overflow: hidden
    }

    .brand-card::after {
      content: attr(data-letter);
      position: absolute;
      right: -10px;
      bottom: -20px;
      font-family: var(--display);
      font-size: 160px;
      line-height: 1;
      opacity: 0.03;
      color: var(--amber);
      pointer-events: none;
      letter-spacing: -0.02em;
    }

    .brand-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
    }

    .bc-osp::before {
      background: linear-gradient(90deg, var(--amber), var(--green))
    }

    .bc-asp::before {
      background: linear-gradient(90deg, var(--green), var(--blue))
    }

    .bc-eyebrow {
      font-family: var(--mono);
      font-size: 10px;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--muted);
      margin-bottom: 16px;
    }

    .bc-name {
      font-family: var(--display);
      font-size: 56px;
      line-height: 1;
      letter-spacing: 0.02em;
      margin-bottom: 4px;
    }

    .bc-osp .bc-name {
      color: var(--amber)
    }

    .bc-asp .bc-name {
      color: var(--green)
    }

    .bc-fullname {
      font-family: var(--mono);
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 24px
    }

    .bc-desc {
      font-size: 14px;
      color: var(--muted);
      line-height: 1.7;
      margin-bottom: 24px;
      font-weight: 300
    }

    .bc-props {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 8px
    }

    .bc-props li {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      font-family: var(--mono);
      font-size: 12px;
      color: var(--muted);
    }

    .bc-props li::before {
      content: '→';
      color: var(--amber);
      flex-shrink: 0;
      margin-top: 1px;
    }

    .bc-asp .bc-props li::before {
      color: var(--green)
    }

    .brand-bridge {
      grid-column: 1/-1;
      background: var(--bg3);
      padding: 20px 40px;
      display: flex;
      align-items: center;
      gap: 20px;
      border-top: 1px solid var(--border);
    }

    .bridge-text {
      font-family: var(--mono);
      font-size: 12px;
      color: var(--muted);
      line-height: 1.7;
    }

    .bridge-text strong {
      color: var(--text)
    }

    /* ── INSTALL SECTION ── */
    #install {
      padding: 80px 0
    }

    .install-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 48px;
      margin-top: 40px;
    }

    .code-window {
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
    }

    .cw-header {
      background: var(--bg3);
      padding: 10px 16px;
      display: flex;
      align-items: center;
      gap: 10px;
      border-bottom: 1px solid var(--border);
    }

    .cw-dots {
      display: flex;
      gap: 6px
    }

    .cw-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%
    }

    .cw-dot-r {
      background: #ff5f57
    }

    .cw-dot-y {
      background: #ffbd2e
    }

    .cw-dot-g {
      background: #28ca41
    }

    .cw-fname {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted);
      margin-left: 6px;
      letter-spacing: 0.04em;
    }

    .cw-lang-tabs {
      display: flex;
      gap: 0;
      border-bottom: 1px solid var(--border);
      background: var(--bg3);
    }

    .ltab {
      font-family: var(--mono);
      font-size: 11px;
      padding: 8px 16px;
      cursor: pointer;
      color: var(--muted);
      border: none;
      background: transparent;
      border-right: 1px solid var(--border);
      border-bottom: 2px solid transparent;
      transition: all 0.15s;
      letter-spacing: 0.04em;
    }

    .ltab.active {
      color: var(--amber);
      border-bottom-color: var(--amber);
      background: var(--amber-glow)
    }

    .cw-body {
      padding: 20px;
      font-family: var(--mono);
      font-size: 12.5px;
      line-height: 1.8;
      display: none
    }

    .cw-body.active {
      display: block
    }

    /* syntax */
    .kw {
      color: #c792ea
    }

    .str {
      color: var(--green)
    }

    .fn {
      color: var(--amber)
    }

    .dec {
      color: var(--blue)
    }

    .cmt {
      color: var(--muted)
    }

    .typ {
      color: var(--blue)
    }

    .num {
      color: #f78c6c
    }

    .pkg {
      color: var(--text)
    }

    .op {
      color: var(--muted)
    }

    /* Right side — step info */
    .steps-list {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-top: 40px
    }

    .step-item {
      display: flex;
      gap: 20px
    }

    .step-num {
      font-family: var(--display);
      font-size: 40px;
      color: var(--dim);
      line-height: 1;
      flex-shrink: 0;
      width: 44px;
    }

    .step-content {}

    .step-title {
      font-weight: 700;
      font-size: 15px;
      color: var(--text);
      margin-bottom: 4px
    }

    .step-desc {
      font-size: 13px;
      color: var(--muted);
      line-height: 1.6
    }

    .step-time {
      font-family: var(--mono);
      font-size: 10.5px;
      color: var(--amber);
      margin-top: 4px;
    }

    /* ── PIPELINE ── */
    #pipeline {
      padding: 80px 0;
      background: var(--bg)
    }

    .pipeline-wrap {
      margin-top: 40px
    }

    .stage-flow {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1px;
      background: var(--border);
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 24px;
    }

    .stage {
      background: var(--bg2);
      padding: 28px 24px;
      cursor: default;
      transition: background 0.2s;
      position: relative;
    }

    .stage:hover {
      background: var(--bg3)
    }

    .stage-label {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--dim);
      letter-spacing: 0.1em;
      margin-bottom: 12px;
    }

    .stage-icon-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 14px;
    }

    .stage-badge {
      font-family: var(--display);
      font-size: 28px;
      color: var(--text);
      letter-spacing: 0.02em;
    }

    .stage-algo {
      font-family: var(--mono);
      font-size: 9.5px;
      padding: 2px 7px;
      border-radius: 2px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .algo-bm25 {
      background: rgba(255, 200, 50, 0.12);
      color: var(--amber);
      border: 1px solid rgba(255, 200, 50, 0.2)
    }

    .algo-embed {
      background: var(--blue-dim);
      color: var(--blue);
      border: 1px solid rgba(56, 189, 248, 0.2)
    }

    .algo-graph {
      background: var(--green-dim);
      color: var(--green);
      border: 1px solid rgba(57, 255, 136, 0.2)
    }

    .algo-pred {
      background: rgba(148, 0, 211, 0.12);
      color: #bf7fff;
      border: 1px solid rgba(148, 0, 211, 0.2)
    }

    .stage-name {
      font-weight: 700;
      font-size: 15px;
      color: var(--text);
      margin-bottom: 6px
    }

    .stage-desc {
      font-size: 12.5px;
      color: var(--muted);
      line-height: 1.55;
      margin-bottom: 16px
    }

    .stage-fail-box {
      background: var(--bg);
      border: 1px solid var(--border);
      padding: 10px 12px;
      border-radius: 2px;
    }

    .sfb-label {
      font-family: var(--mono);
      font-size: 9.5px;
      color: var(--red);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      display: block;
      margin-bottom: 3px;
    }

    .sfb-text {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted);
      line-height: 1.5
    }

    /* DETERMINISM NOTE */
    .det-note {
      background: var(--bg2);
      border: 1px solid var(--border);
      border-left: 3px solid var(--amber);
      padding: 16px 20px;
      border-radius: 2px;
      font-family: var(--mono);
      font-size: 12px;
      color: var(--muted);
      line-height: 1.7;
    }

    .det-note strong {
      color: var(--amber)
    }

    /* ── PLAYGROUND ── */
    #playground {
      padding: 80px 0
    }

    .pg-wrap {
      margin-top: 40px;
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
    }

    .pg-bar {
      background: var(--bg3);
      padding: 10px 20px;
      display: flex;
      align-items: center;
      gap: 8px;
      border-bottom: 1px solid var(--border);
    }

    .pg-dots {
      display: flex;
      gap: 5px
    }

    .pg-d {
      width: 10px;
      height: 10px;
      border-radius: 50%
    }

    .pg-fname {
      font-family: var(--mono);
      font-size: 11.5px;
      color: var(--muted);
      margin-left: 8px
    }

    .pg-badge {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--green);
      background: var(--green-dim);
      border: 1px solid rgba(57, 255, 136, 0.2);
      padding: 2px 8px;
      border-radius: 2px;
      margin-left: auto;
    }

    .pg-body {
      display: grid;
      grid-template-columns: 420px 1fr;
      min-height: 520px
    }

    /* INPUT PANE */
    .pg-input {
      background: var(--bg2);
      padding: 28px;
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .pil {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--dim);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      margin-bottom: 6px;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px
    }

    .chip {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted);
      background: var(--bg);
      border: 1px solid var(--border);
      padding: 5px 11px;
      border-radius: 2px;
      cursor: pointer;
      transition: all 0.15s;
      user-select: none;
    }

    .chip:hover,
    .chip.active {
      border-color: var(--amber);
      color: var(--amber);
      background: var(--amber-glow);
    }

    .qinput {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 2px;
      padding: 12px 14px;
      font-family: var(--mono);
      font-size: 13px;
      color: var(--text);
      width: 100%;
      resize: none;
      height: 76px;
      outline: none;
      transition: border-color 0.2s;
    }

    .qinput:focus {
      border-color: var(--border2)
    }

    .run-btn {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      background: var(--amber);
      color: var(--bg);
      font-family: var(--mono);
      font-size: 13px;
      font-weight: 600;
      padding: 12px;
      border-radius: 2px;
      border: none;
      cursor: pointer;
      letter-spacing: 0.04em;
      transition: all 0.2s;
    }

    .run-btn:hover {
      background: #ffe066
    }

    .run-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed
    }

    /* SKILL REGISTRY */
    .registry-box {
      background: var(--bg);
      border: 1px solid var(--border);
      padding: 14px;
      border-radius: 2px;
    }

    .skill-chip {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      font-family: var(--mono);
      font-size: 10.5px;
      color: var(--muted);
      background: var(--bg2);
      border: 1px solid var(--border);
      padding: 3px 9px;
      border-radius: 2px;
      margin: 3px;
    }

    .r-low {
      background: rgba(57, 255, 136, 0.1);
      color: var(--green);
      border: 1px solid rgba(57, 255, 136, 0.2);
      font-size: 9px;
      padding: 1px 5px;
      border-radius: 1px;
      text-transform: uppercase;
      font-weight: 600
    }

    .r-med {
      background: rgba(255, 200, 50, 0.1);
      color: var(--amber);
      border: 1px solid rgba(255, 200, 50, 0.2);
      font-size: 9px;
      padding: 1px 5px;
      border-radius: 1px;
      text-transform: uppercase;
      font-weight: 600
    }

    .r-high {
      background: var(--red-dim);
      color: var(--red);
      border: 1px solid rgba(255, 77, 106, 0.2);
      font-size: 9px;
      padding: 1px 5px;
      border-radius: 1px;
      text-transform: uppercase;
      font-weight: 600
    }

    /* OUTPUT PANE */
    .pg-output {
      background: var(--bg);
      padding: 28px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 0;
    }

    .pg-placeholder {
      margin: auto;
      text-align: center;
      font-family: var(--mono);
      font-size: 12px;
      color: var(--dim);
      line-height: 2;
    }

    /* pipeline step */
    .pstep {
      display: flex;
      gap: 14px;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255, 200, 50, 0.04);
      opacity: 0;
      transform: translateX(6px);
      transition: all 0.3s ease;
    }

    .pstep.show {
      opacity: 1;
      transform: translateX(0)
    }

    .pstep-track {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex-shrink: 0;
      width: 20px;
    }

    .psdot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--dim);
      flex-shrink: 0;
      margin-top: 4px;
      transition: background 0.3s;
    }

    .psdot.ok {
      background: var(--green)
    }

    .psdot.run {
      background: var(--amber);
      animation: blink 0.8s infinite
    }

    .psdot.err {
      background: var(--red)
    }

    @keyframes blink {
      50% {
        opacity: 0.2
      }
    }

    .psline {
      width: 1px;
      flex: 1;
      background: var(--border);
      margin: 3px auto;
      min-height: 16px;
    }

    .pstep-body {
      flex: 1
    }

    .pstep-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 3px;
    }

    .pstep-name {
      font-family: var(--mono);
      font-size: 10.5px;
      color: var(--muted);
      letter-spacing: 0.06em
    }

    .pstep-ms {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--dim)
    }

    .pstep-detail {
      font-family: var(--mono);
      font-size: 11.5px;
      color: var(--dim);
      line-height: 1.6
    }

    .pstep-detail .hl {
      color: var(--muted)
    }

    .pstep-detail .val {
      color: var(--green)
    }

    .pstep-detail .sc {
      color: var(--amber)
    }

    .pstep-detail .err {
      color: var(--red)
    }

    /* result */
    .result-card {
      margin-top: 16px;
      background: var(--bg2);
      border: 1px solid rgba(57, 255, 136, 0.2);
      border-radius: 2px;
      padding: 20px;
      opacity: 0;
      transition: opacity 0.4s 0.1s;
    }

    .result-card.show {
      opacity: 1
    }

    .rc-label {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--green);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      margin-bottom: 10px
    }

    .rc-skill {
      font-family: var(--display);
      font-size: 26px;
      color: var(--text);
      margin-bottom: 10px;
      letter-spacing: 0.02em
    }

    .rc-tags {
      display: flex;
      gap: 8px;
      flex-wrap: wrap
    }

    .rc-tag {
      font-family: var(--mono);
      font-size: 10.5px;
      color: var(--muted);
      border: 1px solid var(--border);
      padding: 3px 8px;
      border-radius: 2px
    }

    /* ── SAFETY ── */
    #safety {
      padding: 80px 0;
      background: var(--bg)
    }

    .safety-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-top: 40px
    }

    .safety-layer {
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 28px;
      transition: border-color 0.2s;
    }

    .safety-layer:hover {
      border-color: var(--border2)
    }

    .sl-num {
      font-family: var(--display);
      font-size: 48px;
      color: var(--dim);
      line-height: 1;
      margin-bottom: 12px
    }

    .sl-name {
      font-weight: 700;
      font-size: 15px;
      color: var(--text);
      margin-bottom: 6px
    }

    .sl-tech {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--amber);
      background: var(--amber-dim);
      border: 1px solid rgba(255, 200, 50, 0.2);
      padding: 2px 8px;
      border-radius: 2px;
      display: inline-block;
      margin-bottom: 12px;
    }

    .sl-desc {
      font-size: 13px;
      color: var(--muted);
      line-height: 1.65
    }

    .anomaly-box {
      grid-column: 1/-1;
      background: var(--bg2);
      border: 1px solid var(--border);
      border-left: 3px solid var(--red);
      border-radius: 4px;
      padding: 24px 28px;
    }

    .ab-head {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px
    }

    .ab-badge {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--red);
      background: var(--red-dim);
      border: 1px solid rgba(255, 77, 106, 0.2);
      padding: 2px 8px;
      border-radius: 2px;
      letter-spacing: 0.08em;
    }

    .ab-title {
      font-weight: 700;
      font-size: 15px
    }

    .ab-code {
      font-family: var(--mono);
      font-size: 12px;
      color: var(--muted);
      line-height: 1.7;
    }

    .ab-code .kl {
      color: var(--red)
    }

    .ab-code .formula {
      color: var(--amber)
    }

    /* ── DEGRADATION ── */
    #degradation {
      padding: 80px 0
    }

    .dg-layout {
      display: grid;
      grid-template-columns: 280px 1fr;
      gap: 2px;
      background: var(--border);
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 40px;
    }

    .dg-states {
      background: var(--bg2);
      display: flex;
      flex-direction: column;
      gap: 1px;
      background: var(--border)
    }

    .dg-state {
      background: var(--bg2);
      padding: 18px 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 14px;
      transition: background 0.15s;
      position: relative;
    }

    .dg-state::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      opacity: 0;
      transition: opacity 0.2s;
    }

    .dg-state:hover,
    .dg-state.active {
      background: var(--bg3)
    }

    .dg-state.active::before {
      opacity: 1
    }

    .d0::before {
      background: var(--green)
    }

    .d1::before {
      background: var(--amber)
    }

    .d2::before {
      background: #ff8c42
    }

    .d3::before {
      background: var(--red)
    }

    .dg-lbl {
      font-family: var(--display);
      font-size: 32px;
      line-height: 1;
      flex-shrink: 0;
    }

    .d0 .dg-lbl {
      color: var(--green)
    }

    .d1 .dg-lbl {
      color: var(--amber)
    }

    .d2 .dg-lbl {
      color: #ff8c42
    }

    .d3 .dg-lbl {
      color: var(--red)
    }

    .dg-info {}

    .dg-name {
      font-weight: 600;
      font-size: 13px;
      color: var(--text);
      margin-bottom: 2px
    }

    .dg-trigger {
      font-size: 11.5px;
      color: var(--muted)
    }

    /* detail */
    .dg-detail {
      background: var(--bg);
      padding: 32px;
      display: flex;
      flex-direction: column;
      gap: 24px
    }

    .dg-state-tag {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-family: var(--mono);
      font-size: 12px;
      padding: 5px 14px;
      border-radius: 2px;
      font-weight: 500;
      align-self: flex-start;
    }

    .dst-d0 {
      background: var(--green-dim);
      color: var(--green);
      border: 1px solid rgba(57, 255, 136, 0.2)
    }

    .dst-d1 {
      background: var(--amber-dim);
      color: var(--amber);
      border: 1px solid rgba(255, 200, 50, 0.2)
    }

    .dst-d2 {
      background: rgba(255, 140, 66, 0.12);
      color: #ff8c42;
      border: 1px solid rgba(255, 140, 66, 0.2)
    }

    .dst-d3 {
      background: var(--red-dim);
      color: var(--red);
      border: 1px solid rgba(255, 77, 106, 0.2)
    }

    .dg-sec-lbl {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--dim);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      margin-bottom: 8px;
    }

    .caps-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 7px
    }

    .caps-list li {
      display: flex;
      align-items: center;
      gap: 10px;
      font-family: var(--mono);
      font-size: 12px;
    }

    .cap-ok {
      color: var(--green)
    }

    .cap-no {
      color: var(--dim)
    }

    .trace-block {
      background: var(--bg2);
      border: 1px solid var(--border);
      padding: 14px;
      border-radius: 2px;
      font-family: var(--mono);
      font-size: 11.5px;
      line-height: 1.8;
      color: var(--dim);
    }

    .tc {
      color: var(--blue)
    }

    .tv {
      color: var(--muted)
    }

    /* ── CONFORMANCE ── */
    #conformance {
      padding: 80px 0;
      background: var(--bg)
    }

    .conf-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 2px;
      background: var(--border);
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 40px;
    }

    .conf-card {
      background: var(--bg2);
      padding: 28px 24px;
      transition: background 0.2s
    }

    .conf-card:hover {
      background: var(--bg3)
    }

    .conf-lv {
      font-family: var(--mono);
      font-size: 10px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      padding: 2px 8px;
      border-radius: 2px;
      display: inline-block;
      margin-bottom: 16px;
      font-weight: 600;
    }

    .lv-core {
      background: var(--amber-dim);
      color: var(--amber);
      border: 1px solid rgba(255, 200, 50, 0.2)
    }

    .lv-safety {
      background: rgba(255, 140, 66, 0.12);
      color: #ff8c42;
      border: 1px solid rgba(255, 140, 66, 0.2)
    }

    .lv-resilience {
      background: var(--green-dim);
      color: var(--green);
      border: 1px solid rgba(57, 255, 136, 0.2)
    }

    .lv-enterprise {
      background: var(--blue-dim);
      color: var(--blue);
      border: 1px solid rgba(56, 189, 248, 0.2)
    }

    .conf-name {
      font-family: var(--display);
      font-size: 24px;
      letter-spacing: 0.02em;
      margin-bottom: 20px
    }

    .conf-tests {
      display: flex;
      flex-direction: column;
      gap: 7px;
      margin-bottom: 20px
    }

    .ct-row {
      display: flex;
      justify-content: space-between;
      font-size: 12px
    }

    .ct-name {
      color: var(--muted)
    }

    .ct-num {
      font-family: var(--mono);
      font-size: 11.5px;
      color: var(--text)
    }

    .badge-prev {
      display: flex;
      align-items: center;
      gap: 6px;
      font-family: var(--mono);
      font-size: 10.5px;
      color: var(--dim);
      background: var(--bg);
      border: 1px solid var(--border);
      padding: 7px 10px;
      border-radius: 2px;
    }

    .bp-dot {
      width: 8px;
      height: 8px;
      border-radius: 1px;
      flex-shrink: 0
    }

    .bpd-core {
      background: var(--amber)
    }

    .bpd-safety {
      background: #ff8c42
    }

    .bpd-resilience {
      background: var(--green)
    }

    .bpd-enterprise {
      background: var(--blue)
    }

    /* CURRENT STATUS */
    .conf-status-row {
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 20px 24px;
      margin-top: 16px;
      display: flex;
      align-items: center;
      gap: 24px;
    }

    .cs-label {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted)
    }

    .cs-result {
      display: flex;
      align-items: center;
      gap: 8px;
      font-family: var(--mono);
      font-size: 13px;
      color: var(--green);
      background: var(--green-dim);
      border: 1px solid rgba(57, 255, 136, 0.2);
      padding: 6px 14px;
      border-radius: 2px;
    }

    .cs-fail {
      font-family: var(--mono);
      font-size: 12px;
      color: var(--red);
      background: var(--red-dim);
      border: 1px solid rgba(255, 77, 106, 0.2);
      padding: 6px 14px;
      border-radius: 2px;
    }

    .cs-sep {
      color: var(--dim)
    }

    /* ── SKILLS MARKETPLACE ── */
    #skills {
      padding: 80px 0
    }

    .skills-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 2px;
      background: var(--border);
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 40px;
    }

    .sk-card {
      background: var(--bg2);
      padding: 24px;
      transition: background 0.2s;
      cursor: default
    }

    .sk-card:hover {
      background: var(--bg3)
    }

    .sk-scope {
      font-family: var(--mono);
      font-size: 9.5px;
      color: var(--muted);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      margin-bottom: 10px;
    }

    .sk-name {
      font-weight: 700;
      font-size: 14px;
      color: var(--text);
      margin-bottom: 4px
    }

    .sk-id {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--amber);
      margin-bottom: 10px
    }

    .sk-desc {
      font-size: 12.5px;
      color: var(--muted);
      line-height: 1.55;
      margin-bottom: 14px
    }

    .sk-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap
    }

    .sk-strat {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--blue);
      background: var(--blue-dim);
      border: 1px solid rgba(56, 189, 248, 0.15);
      padding: 2px 7px;
      border-radius: 2px;
    }

    .sk-keywords {
      font-family: var(--mono);
      font-size: 10.5px;
      color: var(--dim);
    }

    .sk-lang {
      font-family: var(--mono);
      font-size: 10px;
      color: #c792ea;
      background: rgba(199, 146, 234, 0.1);
      border: 1px solid rgba(199, 146, 234, 0.2);
      padding: 2px 7px;
      border-radius: 2px;
    }

    /* ── CLI SECTION ── */
    #cli {
      padding: 80px 0;
      background: var(--bg)
    }

    .cli-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      margin-top: 40px
    }

    .cli-commands {
      display: flex;
      flex-direction: column;
      gap: 10px
    }

    .cli-cmd {
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 2px;
      padding: 14px 18px;
      display: flex;
      align-items: flex-start;
      gap: 14px;
      transition: all 0.2s;
    }

    .cli-cmd:hover {
      border-color: var(--border2);
      background: var(--bg3)
    }

    .cli-cmd-text {
      font-family: var(--mono);
      font-size: 13px;
      color: var(--amber);
      flex-shrink: 0;
      white-space: nowrap;
    }

    .cli-cmd-sep {
      color: var(--dim);
      flex-shrink: 0
    }

    .cli-cmd-desc {
      font-size: 13px;
      color: var(--muted);
      line-height: 1.5
    }

    .cli-demo {
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
      height: fit-content;
    }

    .terminal-body {
      padding: 20px;
      font-family: var(--mono);
      font-size: 12.5px;
      line-height: 2;
    }

    .t-prompt {
      color: var(--muted)
    }

    .t-cmd {
      color: var(--text)
    }

    .t-ok {
      color: var(--green)
    }

    .t-fail {
      color: var(--red)
    }

    .t-info {
      color: var(--amber)
    }

    .t-dim {
      color: var(--dim)
    }

    /* ── ERROR TAXONOMY ── */
    #errors {
      padding: 80px 0
    }

    .error-table {
      width: 100%;
      border-collapse: collapse;
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 40px;
    }

    .error-table thead tr {
      background: var(--bg3)
    }

    .error-table th {
      padding: 12px 16px;
      font-family: var(--mono);
      font-size: 10.5px;
      color: var(--muted);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    .error-table tbody tr {
      border-bottom: 1px solid var(--border);
      transition: background 0.15s
    }

    .error-table tbody tr:last-child {
      border-bottom: none
    }

    .error-table tbody tr:hover {
      background: var(--bg2)
    }

    .error-table td {
      padding: 11px 16px;
      font-size: 13px;
      color: var(--muted);
      border-right: 1px solid var(--border)
    }

    .error-table td:last-child {
      border-right: none
    }

    .error-table td:first-child {
      font-family: var(--mono);
      font-size: 12px;
      color: var(--amber)
    }

    .error-table td:nth-child(2) {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--blue)
    }

    /* ── STATUS ── */
    #status {
      padding: 80px 0;
      background: var(--bg)
    }

    .status-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 40px
    }

    .stat-card {
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 24px;
    }

    .sc-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
    }

    .sc-title {
      font-weight: 600;
      font-size: 13px;
      color: var(--text)
    }

    .sc-live {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--green);
      background: var(--green-dim);
      border: 1px solid rgba(57, 255, 136, 0.2);
      padding: 2px 8px;
      border-radius: 2px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .uptime-strip {
      display: flex;
      gap: 2px;
      margin-bottom: 8px
    }

    .ub {
      height: 24px;
      flex: 1;
      border-radius: 1px;
      background: rgba(57, 255, 136, 0.3);
      transition: background 0.2s
    }

    .ub:hover {
      background: var(--green)
    }

    .ub.down {
      background: rgba(255, 77, 106, 0.4)
    }

    .uptime-big {
      font-family: var(--display);
      font-size: 42px;
      color: var(--green);
      letter-spacing: 0.02em
    }

    .uptime-sub {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--dim);
      margin-top: 2px
    }

    /* LIVE FEED */
    .feed-list {
      display: flex;
      flex-direction: column;
      gap: 6px
    }

    .fi {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 7px 11px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 2px;
      font-family: var(--mono);
      font-size: 11px;
    }

    .fi-time {
      color: var(--dim);
      min-width: 52px
    }

    .fi-skill {
      color: var(--muted);
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis
    }

    .fi-score {
      color: var(--amber)
    }

    .fi-ok {
      color: var(--green)
    }

    .fi-block {
      color: var(--red)
    }

    .metrics-strip {
      grid-column: 1/-1;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 2px;
      background: var(--border);
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
    }

    .ms-card {
      background: var(--bg2);
      padding: 18px 20px
    }

    .ms-val {
      font-family: var(--display);
      font-size: 32px;
      color: var(--text);
      line-height: 1;
      margin-bottom: 4px
    }

    .ms-lbl {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted)
    }

    /* ── ADOPT ── */
    #adopt {
      padding: 80px 0
    }

    .adopt-steps {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 2px;
      background: var(--border);
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 40px;
      margin-bottom: 24px;
    }

    .as-step {
      background: var(--bg2);
      padding: 32px 24px;
      transition: background 0.2s
    }

    .as-step:hover {
      background: var(--bg3)
    }

    .as-num {
      font-family: var(--display);
      font-size: 64px;
      color: var(--dim);
      line-height: 1;
      margin-bottom: 14px;
    }

    .as-title {
      font-weight: 700;
      font-size: 14px;
      color: var(--text);
      margin-bottom: 6px
    }

    .as-desc {
      font-size: 13px;
      color: var(--muted);
      line-height: 1.6
    }

    .as-time {
      font-family: var(--mono);
      font-size: 10.5px;
      color: var(--amber);
      margin-top: 10px
    }

    .adopters-box {
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 24px;
    }

    .ab-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px
    }

    .ab-title {
      font-weight: 600;
      font-size: 13px
    }

    .ab-count {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted)
    }

    .adopters-row {
      display: grid;
      grid-template-columns: 1fr 1fr 2fr;
      gap: 12px
    }

    .adopter {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 2px;
      padding: 16px
    }

    .adopter-name {
      font-weight: 700;
      font-size: 13.5px;
      color: var(--text);
      margin-bottom: 3px
    }

    .adopter-stack {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted);
      margin-bottom: 8px
    }

    .adopter-badge {
      font-family: var(--mono);
      font-size: 9.5px;
      color: var(--green);
      background: var(--green-dim);
      border: 1px solid rgba(57, 255, 136, 0.2);
      padding: 2px 7px;
      border-radius: 2px;
    }

    .be-first-card {
      background: var(--bg);
      border: 1px dashed var(--border);
      border-radius: 2px;
      padding: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .be-first-card:hover {
      border-color: var(--amber)
    }

    .bfc-inner {
      text-align: center
    }

    .bfc-plus {
      font-family: var(--display);
      font-size: 32px;
      color: var(--dim);
      margin-bottom: 4px
    }

    .bfc-text {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--dim);
      line-height: 1.5
    }

    .bfc-text span {
      color: var(--amber)
    }

    /* ── FOOTER ── */
    footer {
      border-top: 1px solid var(--border);
      padding: 40px 48px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      flex-wrap: wrap;
      gap: 24px;
    }

    .footer-brand .osp-mark-lg {
      font-family: var(--mono);
      font-size: 16px;
      font-weight: 600;
      color: var(--bg);
      background: var(--amber);
      padding: 4px 10px;
      border-radius: 2px;
      display: inline-block;
      margin-bottom: 8px;
    }

    .footer-brand p {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted)
    }

    .footer-links {
      display: flex;
      gap: 24px;
      flex-wrap: wrap
    }

    .footer-links a {
      font-family: var(--mono);
      font-size: 12px;
      color: var(--dim);
      text-decoration: none;
      transition: color 0.2s;
    }

    .footer-links a:hover {
      color: var(--amber)
    }

    .footer-lic {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--dim);
      text-align: right;
      line-height: 1.7
    }

    /* ── COMPARISON TABLE ── */
    #comparison {
      padding: 80px 0
    }

    .cmp-table {
      width: 100%;
      border-collapse: collapse;
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 40px;
    }

    .cmp-table thead tr {
      background: var(--bg3)
    }

    .cmp-table th {
      padding: 13px 16px;
      font-family: var(--mono);
      font-size: 10.5px;
      color: var(--muted);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      text-align: left;
      border-bottom: 1px solid var(--border);
      border-right: 1px solid var(--border);
    }

    .cmp-table th:last-child {
      border-right: none
    }

    .cmp-table th.osp-th {
      color: var(--amber);
      background: var(--amber-glow)
    }

    .cmp-table tbody tr {
      border-bottom: 1px solid var(--border);
      transition: background 0.15s
    }

    .cmp-table tbody tr:last-child {
      border-bottom: none
    }

    .cmp-table tbody tr:hover {
      background: var(--bg2)
    }

    .cmp-table td {
      padding: 12px 16px;
      font-size: 13px;
      color: var(--muted);
      border-right: 1px solid var(--border);
    }

    .cmp-table td:last-child {
      border-right: none
    }

    .cmp-table td:first-child {
      color: var(--text);
      font-size: 13px
    }

    .cmp-table td.osp-td {
      background: var(--amber-glow);
      color: var(--text);
      font-weight: 600
    }

    .chk {
      color: var(--green);
      font-weight: 700
    }

    .crs {
      color: var(--dim)
    }

    .prt {
      color: var(--amber)
    }

    /* ── SCROLL REVEAL ── */
    .reveal {
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.8s ease, transform 0.8s ease;
    }

    .reveal.visible {
      opacity: 1;
      transform: none
    }

    .reveal-left {
      opacity: 0;
      transform: translateX(-40px);
      transition: opacity 0.8s ease, transform 0.8s ease
    }

    .reveal-right {
      opacity: 0;
      transform: translateX(40px);
      transition: opacity 0.8s ease, transform 0.8s ease
    }

    .reveal-left.visible,
    .reveal-right.visible {
      opacity: 1;
      transform: none
    }

    /* ── PARTICLE CANVAS ── */
    #particleCanvas {
      position: absolute;
      inset: 0;
      z-index: 0;
      pointer-events: none;
    }

    #hero {
      position: relative;
      overflow: hidden
    }

    #hero .hero-inner {
      position: relative;
      z-index: 2
    }

    /* ── CARD HOVER MICRO-ANIMATIONS ── */
    .sk-card {
      transition: all 0.3s ease
    }

    .sk-card:hover {
      transform: translateY(-4px);
      border-color: var(--amber) !important;
      box-shadow: 0 8px 32px rgba(255, 200, 50, 0.08)
    }

    .stage {
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden
    }

    .stage:hover {
      background: var(--bg3)
    }

    .stage::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--amber), var(--green));
      transition: width 0.4s ease;
    }

    .stage:hover::after {
      width: 100%
    }

    .conf-card {
      transition: all 0.3s ease
    }

    .conf-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3)
    }

    .brand-card {
      transition: all 0.3s ease
    }

    .brand-card:hover {
      background: var(--bg3)
    }

    .stat-card {
      transition: all 0.3s ease
    }

    .stat-card:hover {
      border-color: var(--amber);
      box-shadow: 0 4px 20px rgba(255, 200, 50, 0.06)
    }

    /* ── BACK TO TOP ── */
    .back-to-top {
      position: fixed;
      bottom: 32px;
      right: 32px;
      z-index: 99;
      width: 44px;
      height: 44px;
      border-radius: 4px;
      background: var(--amber);
      color: var(--bg);
      border: none;
      cursor: pointer;
      font-size: 20px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.3s ease;
      pointer-events: none;
      box-shadow: 0 4px 16px rgba(255, 200, 50, 0.3);
    }

    .back-to-top.show {
      opacity: 1;
      transform: none;
      pointer-events: auto
    }

    .back-to-top:hover {
      background: #ffe066;
      transform: translateY(-2px)
    }

    /* ── HAMBURGER MENU ── */
    .nav-hamburger {
      display: none;
      background: none;
      border: none;
      cursor: pointer;
      width: 32px;
      height: 32px;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 5px;
    }

    .nav-hamburger span {
      display: block;
      width: 20px;
      height: 2px;
      background: var(--muted);
      transition: all 0.3s;
    }

    .nav-hamburger.open span:nth-child(1) {
      transform: rotate(45deg) translate(3px, 3px)
    }

    .nav-hamburger.open span:nth-child(2) {
      opacity: 0
    }

    .nav-hamburger.open span:nth-child(3) {
      transform: rotate(-45deg) translate(4px, -4px)
    }

    /* ── COUNTER ANIMATION ── */
    .count-up {
      display: inline-block
    }

    /* RESPONSIVE */
    @media(max-width:900px) {

      .container,
      .hero-inner {
        padding: 0 24px
      }

      nav {
        padding: 0 16px
      }

      footer {
        padding: 32px 24px
      }

      .hero-inner,
      .install-grid,
      .brand-split-grid,
      .safety-grid,
      .cli-grid,
      .status-grid {
        grid-template-columns: 1fr
      }

      .stage-flow,
      .conf-grid,
      .adopt-steps,
      .metrics-strip {
        grid-template-columns: 1fr 1fr
      }

      .skills-grid,
      .adopters-row {
        grid-template-columns: 1fr
      }

      .dg-layout {
        grid-template-columns: 1fr
      }

      .pg-body {
        grid-template-columns: 1fr
      }

      h1 {
        font-size: 64px
      }

      .nav-hamburger {
        display: flex
      }

      .nav-links {
        display: none;
        position: absolute;
        top: 60px;
        left: 0;
        right: 0;
        background: rgba(8, 11, 15, 0.98);
        backdrop-filter: blur(16px);
        flex-direction: column;
        padding: 20px 24px;
        gap: 16px;
        border-bottom: 1px solid var(--border);
      }

      .nav-links.open {
        display: flex
      }

      .nav-status {
        display: none
      }

      .nav-title span {
        display: none
      }

      #particleCanvas {
        display: none
      }

      .cmp-table {
        font-size: 11px
      }

      .cmp-table td,
      .cmp-table th {
        padding: 8px 10px
      }
    }

    @media(max-width:600px) {
      h1 {
        font-size: 48px
      }

      h2 {
        font-size: 36px
      }

      .stage-flow,
      .conf-grid,
      .adopt-steps,
      .metrics-strip {
        grid-template-columns: 1fr
      }

      .m-val {
        font-size: 32px
      }

      .hero-btns {
        flex-direction: column
      }

      .hero-btns a {
        text-align: center
      }
    }
  </style>
</head>

<body>

  <!-- NAV -->
  <nav>
    <div class="nav-logo">
      <span class="osp-mark">OSP</span>
      <span class="nav-title"><span>Open Skills Protocol</span> · openskillsprotocol.dev</span>
    </div>
    <ul class="nav-links">
      <li><a href="#install">Install</a></li>
      <li><a href="#pipeline">Pipeline</a></li>
      <li><a href="#playground">Playground</a></li>
      <li><a href="#skills">Skills</a></li>
      <li><a href="#cli">CLI</a></li>
      <li><a href="#conform" class="nav-cta">Conformance →</a></li>
    </ul>
    <button class="nav-hamburger"
      onclick="this.classList.toggle('open');document.querySelector('.nav-links').classList.toggle('open')"
      aria-label="Menu">
      <span></span><span></span><span></span>
    </button>
    <div class="nav-status">
      <span class="pulse"></span>
      v0.3.2 · 17/18 passing
    </div>
  </nav>

  <!-- HERO -->
  <section id="hero">
    <canvas id="particleCanvas"></canvas>
    <div class="hero-inner">
      <div class="hero-left">
        <div class="hero-tag">
          <span class="dot"></span>
          Open Standard · Apache 2.0 · Originated from AMADEQ Skills Protocol
        </div>
        <h1>
          <div class="h1-line1">OPEN</div>
          <div class="h1-line2">SKILLS</div>
          <div class="h1-line3">PROTOCOL</div>
        </h1>
        <p class="hero-sub">
          The vendor-neutral standard for <strong>packaging, routing, and safely executing skills</strong>
          in multi-persona AI systems. Real BM25. Real embeddings. Real cryptographic signing.
        </p>
        <div class="hero-btns">
          <a href="#install" class="btn-amber">pip install osp-sdk</a>
          <a href="#playground" class="btn-ghost">▶ Live Demo</a>
          <a href="#" class="btn-ghost">GitHub →</a>
        </div>

        <!-- INSTALL BLOCK -->
        <div class="install-block">
          <div class="install-tabs">
            <button class="itab active" onclick="switchInstall(this,'pip')">pip</button>
            <button class="itab" onclick="switchInstall(this,'npm')">npm</button>
            <button class="itab" onclick="switchInstall(this,'go')">go</button>
          </div>
          <div class="install-code active" id="install-pip">
            <span class="ic-comment"># minimal</span>
            <span class="ic-cmd">pip install</span> <span class="ic-pkg">osp-sdk</span>

            <span class="ic-comment"># + BM25 routing + sentence-transformers</span>
            <span class="ic-cmd">pip install</span> <span class="ic-pkg">osp-sdk</span><span class="ic-flag">[ml]</span>

            <span class="ic-comment"># full: +crypto +monitoring +fastapi</span>
            <span class="ic-cmd">pip install</span> <span class="ic-pkg">osp-sdk</span><span
              class="ic-flag">[full]</span>
          </div>
          <div class="install-code" id="install-npm">
            <span class="ic-comment"># OSP conformance CLI tool</span>
            <span class="ic-cmd">npm install</span> <span class="ic-flag">-g</span> <span
              class="ic-pkg">@osp/check</span>

            <span class="ic-comment"># run against your implementation</span>
            <span class="ic-cmd">npx osp-check</span> <span class="ic-flag">--level</span> core
          </div>
          <div class="install-code" id="install-go">
            <span class="ic-comment"># Go reference client</span>
            <span class="ic-cmd">go get</span> <span class="ic-pkg">github.com/open-skills-protocol/osp-go</span>

            <span class="ic-comment"># import in your code</span>
            <span class="ic-comment">// import "github.com/open-skills-protocol/osp-go/routing"</span>
          </div>
        </div>
      </div>

      <div class="hero-right">
        <div class="metrics-vertical">
          <div class="metric-row">
            <div class="m-val">&lt;<span class="unit">1</span>ms</div>
            <div class="m-label">Stage 0 routing latency</div>
          </div>
          <div class="metric-row">
            <div class="m-val">17<span class="unit">/18</span></div>
            <div class="m-label">Conformance tests passing</div>
          </div>
          <div class="metric-row">
            <div class="m-val">D<span class="unit">0–3</span></div>
            <div class="m-label">Graceful degradation states</div>
          </div>
          <div class="metric-row">
            <div class="m-val">ES<span class="unit">256</span></div>
            <div class="m-label">JCS RFC 8785 signed responses</div>
          </div>
          <div class="metric-row">
            <div class="m-val">1<span class="unit">,500+</span></div>
            <div class="m-label">AI avatars in production (ASP)</div>
          </div>
        </div>
        <div class="conformance-bar">
          <div class="conf-progress">
            <div class="conf-fill" id="confFill"></div>
          </div>
          <div class="conf-label">94.4% passing · latest run 2h ago</div>
        </div>
      </div>
    </div>
  </section>

  <hr class="section-divider">

  <!-- BRAND SPLIT -->
  <section id="brand-split">
    <div class="container">
      <div class="s-tag">Architecture</div>
      <h2>STANDARD vs.<br>IMPLEMENTATION</h2>
      <p class="s-desc">OSP is the open standard. ASP (AMADEQ Skills Protocol) is the reference implementation — proving
        the standard at production scale with 1,500+ avatars.</p>

      <div class="brand-split-grid">
        <div class="brand-card bc-osp" data-letter="OSP">
          <div class="bc-eyebrow">Open Standard · Vendor-Neutral</div>
          <div class="bc-name">OSP</div>
          <div class="bc-fullname">Open Skills Protocol · github.com/open-skills-protocol</div>
          <div class="bc-desc">JSON Schemas, routing contracts, conformance test vectors, and governance rules. Owned by
            the community. No single vendor controls merge rights. Apache 2.0.</div>
          <ul class="bc-props">
            <li>Neutral GitHub org — 2-of-N RFC approval required</li>
            <li>SkillManifest, RoutingDecision, TraceEvent, SafetyDecision schemas</li>
            <li>4-stage routing pipeline contract (Filter → Score → Rerank → Resolve)</li>
            <li>D0–D3 degradation automaton with named transitions</li>
            <li>Any language, any model, any vector store — zero requirements</li>
            <li>Apache 2.0 (spec) + CC BY 4.0 (docs)</li>
          </ul>
        </div>
        <div class="brand-card bc-asp" data-letter="ASP">
          <div class="bc-eyebrow">Reference Implementation · AMADEQ Project</div>
          <div class="bc-name">ASP</div>
          <div class="bc-fullname">AMADEQ Skills Protocol · amadeq.org</div>
          <div class="bc-desc">Production OSP implementation powering MetaHuman AI tutors, counselors, and companions.
            Python + Qdrant + sentence-transformers on RTX 5090 infrastructure.</div>
          <ul class="bc-props">
            <li>First OSP Resilience conformant implementation</li>
            <li>Real BM25 (Okapi) + batch sentence-transformers Stage 2</li>
            <li>KL-divergence anomaly brake in safety pipeline</li>
            <li>JCS RFC 8785 + ES256/EdDSA/HMAC signing &amp; verification</li>
            <li>Configurable activation keyword strategies per skill</li>
            <li>psutil auto-degradation monitoring, hysteresis controller</li>
          </ul>
        </div>
        <div class="brand-bridge">
          <div class="bridge-text">
            <strong>ASP implements OSP</strong> exactly as Chrome implements HTML or Nginx implements HTTP —
            the standard outlives any single implementation. Every team adopting OSP promotes AMADEQ as its origin.
            Every conformant implementation proves the spec is implementable from its text alone.
          </div>
        </div>
      </div>
    </div>
  </section>

  <hr class="section-divider">

  <!-- INSTALL / QUICKSTART -->
  <section id="install">
    <div class="container">
      <div class="s-tag">Quick Start</div>
      <h2>FROM ZERO<br>TO ROUTING</h2>
      <p class="s-desc">The @skill decorator transforms any Python function into an OSP-compliant skill with a full
        manifest, BM25 keywords, and cryptographic signing.</p>

      <div class="install-grid">
        <div class="code-window">
          <div class="cw-header">
            <div class="cw-dots">
              <div class="cw-dot cw-dot-r"></div>
              <div class="cw-dot cw-dot-y"></div>
              <div class="cw-dot cw-dot-g"></div>
            </div>
            <span class="cw-fname">hello.py — examples/hello.py (real file)</span>
          </div>
          <div class="cw-lang-tabs">
            <button class="ltab active" onclick="switchLang(this,'py')">Python</button>
            <button class="ltab" onclick="switchLang(this,'ts')">TypeScript</button>
            <button class="ltab" onclick="switchLang(this,'routing')">Routing API</button>
          </div>
          <div class="cw-body active" id="lang-py"><span class="kw">from</span> <span class="pkg">asp</span> <span
              class="kw">import</span> <span class="fn">skill</span>, <span class="fn">serve</span>

            <span class="cmt"># @skill transforms any function into an OSP skill</span>
            <span class="dec">@skill</span>(<span class="str">"greet"</span>,
            description=<span class="str">"Say hello to someone"</span>,
            keywords=[<span class="str">"hello"</span>, <span class="str">"greet"</span>, <span
              class="str">"hi"</span>],
            risk_level=<span class="str">"LOW"</span>)
            <span class="kw">def</span> <span class="fn">greet</span>(name: <span class="typ">str</span> = <span
              class="str">"World"</span>) -> <span class="typ">str</span>:
            <span class="str">"""Greet someone by name."""</span>
            <span class="kw">return</span> <span class="str">f"Hello, </span>{name}<span class="str">! 👋"</span>

            <span class="dec">@skill</span>(<span class="str">"calculator"</span>,
            description=<span class="str">"Perform math calculations"</span>,
            keywords=[<span class="str">"math"</span>, <span class="str">"calc"</span>, <span
              class="str">"calculate"</span>],
            risk_level=<span class="str">"LOW"</span>)
            <span class="kw">def</span> <span class="fn">calculator</span>(expression: <span class="typ">str</span>) ->
            <span class="typ">str</span>:
            <span class="kw">return</span> <span class="fn">str</span>(<span class="fn">eval</span>(expression))

            <span class="fn">serve</span>() <span class="cmt"># → http://localhost:8080 + /_dashboard</span>
          </div>
          <div class="cw-body" id="lang-ts"><span class="cmt">// TypeScript SDK (in development)</span>
            <span class="kw">import</span> { skill, serve } <span class="kw">from</span> <span
              class="str">"@osp/sdk"</span>

            <span class="dec">@skill</span>({
            id: <span class="str">"greet"</span>,
            description: <span class="str">"Say hello to someone"</span>,
            keywords: [<span class="str">"hello"</span>, <span class="str">"greet"</span>, <span
              class="str">"hi"</span>],
            riskLevel: <span class="str">"LOW"</span>,
            version: <span class="str">"1.0.0"</span>
            })
            <span class="kw">async function</span> <span class="fn">greet</span>(name: <span class="typ">string</span>):
            <span class="typ">Promise</span>&lt;<span class="typ">string</span>&gt; {
            <span class="kw">return</span> <span class="str">`Hello, ${name}!`</span>
            }

            <span class="fn">serve</span>({ port: <span class="num">8080</span> }) <span class="cmt">// OSP JSON-RPC
              2.0</span>
          </div>
          <div class="cw-body" id="lang-routing"><span class="cmt"># Direct routing API (asp.route JSON-RPC)</span>
            <span class="kw">import</span> <span class="pkg">requests</span>

            result = <span class="pkg">requests</span>.<span class="fn">post</span>(<span
              class="str">"http://localhost:8080/asp-rpc"</span>, json={
            <span class="str">"jsonrpc"</span>: <span class="str">"2.0"</span>,
            <span class="str">"method"</span>: <span class="str">"asp.route"</span>,
            <span class="str">"params"</span>: {
            <span class="str">"query"</span>: <span class="str">"Say hi to Alex"</span>,
            <span class="str">"routing_conditions"</span>: {<span class="str">"skip_semantic"</span>: <span
              class="kw">False</span>}
            },
            <span class="str">"id"</span>: <span class="num">1</span>
            }).<span class="fn">json</span>()

            <span class="cmt"># Response:</span>
            <span class="cmt"># { skill_ref: "greet", safety_clearance: "allow",</span>
            <span class="cmt"># decision_stability: "semantic_supported",</span>
            <span class="cmt"># trace_events: [...] }</span>
          </div>
        </div>

        <div>
          <div class="steps-list">
            <div class="step-item">
              <div class="step-num">01</div>
              <div class="step-content">
                <div class="step-title">Install SDK</div>
                <div class="step-desc">pip install osp-sdk[ml] — includes BM25 routing + sentence-transformers for Stage
                  2 semantic reranking.</div>
                <div class="step-time">~30 seconds</div>
              </div>
            </div>
            <div class="step-item">
              <div class="step-num">02</div>
              <div class="step-content">
                <div class="step-title">Decorate your functions</div>
                <div class="step-desc">@skill() auto-extracts parameter types, generates L0 manifest, registers in
                  global registry. One decorator, full OSP compliance.</div>
                <div class="step-time">~5 minutes</div>
              </div>
            </div>
            <div class="step-item">
              <div class="step-num">03</div>
              <div class="step-content">
                <div class="step-title">serve() — zero config</div>
                <div class="step-desc">Starts JSON-RPC 2.0 server on :8080. Built-in /_dashboard, /health, /skills. Full
                  4-stage pipeline activated automatically.</div>
                <div class="step-time">~1 line of code</div>
              </div>
            </div>
            <div class="step-item">
              <div class="step-num">04</div>
              <div class="step-content">
                <div class="step-title">osp check — validate conformance</div>
                <div class="step-desc">Run the OSP Core conformance suite against your implementation. 20 routing
                  vectors + 5 negative tests. Pass → earn your badge.</div>
                <div class="step-time">~15 minutes</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <hr class="section-divider">

  <!-- PIPELINE -->
  <section id="pipeline">
    <div class="container">
      <div class="s-tag">Core Architecture</div>
      <h2>4-STAGE<br>ROUTING PIPELINE</h2>
      <p class="s-desc">No generative LLM in the routing path. Every stage deterministic. Every failure emits a
        TraceEvent — silent degradation is a conformance violation.</p>

      <div class="pipeline-wrap">
        <div class="stage-flow">
          <div class="stage">
            <div class="stage-label">STAGE 0</div>
            <div class="stage-icon-row">
              <div class="stage-badge">Filter</div>
              <div class="stage-algo algo-pred">Predicate</div>
            </div>
            <div class="stage-name">Candidate Reduction</div>
            <div class="stage-desc">L0 catalog-lite lookup — 4KB max per record. Capability, mode, and context
              predicates. Bounded and non-blocking. All 1000+ skills scanned, subset passed forward.</div>
            <div class="stage-fail-box">
              <span class="sfb-label">on failure</span>
              <div class="sfb-text">Empty result → ROUTING_POOL_EMPTY TraceEvent emitted. Never silent.</div>
            </div>
          </div>

          <div class="stage">
            <div class="stage-label">STAGE 1</div>
            <div class="stage-icon-row">
              <div class="stage-badge">Score</div>
              <div class="stage-algo algo-bm25">BM25</div>
            </div>
            <div class="stage-name">Lexical Scoring</div>
            <div class="stage-desc">Okapi BM25 with pre-built IDF table across candidate corpus. Compiled regex at
              module level. LRU cache (256 entries). Escape hatch for early Stage 2 promotion.</div>
            <div class="stage-fail-box">
              <span class="sfb-label">on failure</span>
              <div class="sfb-text">Timeout → ROUTING_FALLBACK_LEXICAL. No retry on same backend+config (I2 invariant).
              </div>
            </div>
          </div>

          <div class="stage">
            <div class="stage-label">STAGE 2</div>
            <div class="stage-icon-row">
              <div class="stage-badge">Rerank</div>
              <div class="stage-algo algo-embed">Cosine</div>
            </div>
            <div class="stage-name">Semantic Reranking</div>
            <div class="stage-desc">Batch sentence-transformers encode (all-MiniLM-L6-v2). One .encode() call for query
              + all candidates. Combined score: α·BM25 + β·Semantic (0.4/0.6). ANN supported.</div>
            <div class="stage-fail-box">
              <span class="sfb-label">on failure</span>
              <div class="sfb-text">Vector store down → STAGE2_EMBEDDING_TIMEOUT → ROUTING_FALLBACK_LEXICAL. Emit
                ANN_APPROXIMATE_RECALL if ANN used.</div>
            </div>
          </div>

          <div class="stage">
            <div class="stage-label">STAGE 3</div>
            <div class="stage-icon-row">
              <div class="stage-badge">Resolve</div>
              <div class="stage-algo algo-graph">Graph</div>
            </div>
            <div class="stage-name">Conflict Resolution</div>
            <div class="stage-desc">IEEE 754 fp64 epsilon comparison (ε=1e-6). Risk-level priority (LOW &lt; MEDIUM &lt;
              HIGH). UTF-8 lexicographic tiebreak on skill_id. O(1) amortized mutual-exclusivity query.</div>
            <div class="stage-fail-box">
              <span class="sfb-label">on failure</span>
              <div class="sfb-text">CONFLICT_GRAPH_UNAVAILABLE → canonical fallback: lowest risk → highest score →
                skill_id asc.</div>
            </div>
          </div>
        </div>

        <div class="det-note">
          <strong>NORMATIVE:</strong> Routing stages 0–3 MUST be deterministic. No autoregressive LLM calls permitted in
          routing path.
          Combined score formula: <strong>score = 0.4 · normalize(BM25) + 0.6 · cosine_similarity</strong>.
          Tie-breaking: ascending skill_id (lexicographical UTF-8 byte order). Safety check runs before Stage 1.
        </div>
      </div>
    </div>
  </section>

  <hr class="section-divider">

  <!-- PLAYGROUND -->
  <section id="playground">
    <div class="container">
      <div class="s-tag">Interactive</div>
      <h2>ROUTING<br>PLAYGROUND</h2>
      <p class="s-desc">Watch the real OSP 4-stage pipeline execute with actual BM25 scoring logic and safety checks
        from the reference implementation.</p>

      <div class="pg-wrap">
        <div class="pg-bar">
          <div class="pg-dots">
            <div class="pg-d" style="background:#ff5f57"></div>
            <div class="pg-d" style="background:#ffbd2e"></div>
            <div class="pg-d" style="background:#28ca41"></div>
          </div>
          <div class="pg-fname">osp-routing-simulator · asp_server/logic/routing.py</div>
          <div class="pg-badge">● LIVE SIMULATION</div>
        </div>
        <div class="pg-body">
          <!-- INPUT -->
          <div class="pg-input">
            <div>
              <div class="pil">Sample Queries</div>
              <div class="chip-row">
                <div class="chip active" onclick="pickChip(this,'Say hi to Alex')">Say hi to Alex</div>
                <div class="chip" onclick="pickChip(this,'Math homework help')">Math homework</div>
                <div class="chip" onclick="pickChip(this,'I feel anxious today')">Emotional support</div>
                <div class="chip" onclick="pickChip(this,'Analyze this YouTube video')">YouTube analysis</div>
                <div class="chip" onclick="pickChip(this,'Find files in my drive')">Google Drive</div>
                <div class="chip" onclick="pickChip(this,'UNION SELECT password FROM users')">SQL injection ⚠</div>
              </div>
            </div>
            <div>
              <div class="pil">Query</div>
              <textarea class="qinput" id="qinput">Say hi to Alex</textarea>
            </div>
            <button class="run-btn" id="runBtn" onclick="runRoute()">
              <span class="run-label">▶ Run 4-Stage Pipeline</span>
              <div class="run-progress" id="runProgress"></div>
            </button>
            <div>
              <div class="pil">L0 Skill Registry (6 skills · metadata.yaml)</div>
              <div class="registry-box">
                <span class="skill-chip">greet@2.1.0 <span class="r-low">LOW</span></span>
                <span class="skill-chip">math-tutor@3.0.1 <span class="r-low">LOW</span></span>
                <span class="skill-chip">psych-counsel@1.4.0 <span class="r-med">MED</span></span>
                <span class="skill-chip">youtube.analyzer@1.0.0 <span class="r-low">LOW</span></span>
                <span class="skill-chip">google.drive@1.0.0 <span class="r-low">LOW</span></span>
                <span class="skill-chip">crisis-support@2.0.0 <span class="r-high">HIGH</span></span>
              </div>
            </div>
          </div>

          <!-- OUTPUT -->
          <div class="pg-output" id="pgOutput">
            <div class="pg-placeholder">
              ← Select a query and run the pipeline<br>
              Watch BM25 scoring, safety check,<br>
              and conflict resolution in real time
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <hr class="section-divider">

  <!-- SAFETY -->
  <section id="safety">
    <div class="container">
      <div class="s-tag">Safety Pipeline</div>
      <h2>THREE-LAYER<br>SAFETY</h2>
      <p class="s-desc">Fail-closed by default. Runs before Stage 1. TF-IDF semantic classifier with 6 risk categories.
        KL-divergence anomaly detection for distribution shift.</p>

      <div class="safety-grid">
        <div class="safety-layer">
          <div class="sl-num">01</div>
          <div class="sl-name">Regex Pre-filters</div>
          <div class="sl-tech">SQL Injection + Command Injection</div>
          <div class="sl-desc">Compiled regex patterns for SQL injection (UNION SELECT, DROP TABLE, OR 1=1) and command
            injection (rm -rf, cat /etc/passwd, $(...)). Fastest layer — microsecond response. Returns
            PREFILTER_SQL_INJECTION or PREFILTER_COMMAND_INJECTION reason codes.</div>
        </div>
        <div class="safety-layer">
          <div class="sl-num">02</div>
          <div class="sl-name">Semantic Classifier</div>
          <div class="sl-tech">TF-IDF + Cosine Similarity · scikit-learn</div>
          <div class="sl-desc">6 risk categories: JAILBREAK, PRIVACY, ILLEGAL, VIOLENCE, MANIPULATION, INTERNAL_STATE.
            TF-IDF vectorizer with ngram_range(1,2). Cosine similarity threshold: 0.15 = suspicious, 0.25 = block. Falls
            back to keyword matching if sklearn unavailable.</div>
        </div>
        <div class="anomaly-box">
          <div class="ab-head">
            <div class="ab-badge">LAYER 3 · ANOMALY DETECTION</div>
            <div class="ab-title">KL-Divergence Distribution Brake</div>
          </div>
          <div class="ab-code">
            Tracks lexical vs semantic score distributions across last 100 requests (bounded deque).<br>
            Computes <span class="kl">D_KL(P||Q)</span> between distributions. Threshold: <span
              class="formula">0.5</span>.<br>
            If <span class="kl">KL > 0.5</span> AND risk_level is HIGH/CRITICAL → <span
              class="kl">CONSERVATIVE_BLOCK_APPLIED</span> + fail-closed.<br>
            If classifier throws any exception → <span class="kl">FAIL_CLOSED_TRIGGERED</span> →
            SAFETY_CLASSIFIER_UNAVAILABLE returned.
          </div>
        </div>
      </div>
    </div>
  </section>

  <hr class="section-divider">

  <!-- DEGRADATION -->
  <section id="degradation">
    <div class="container">
      <div class="s-tag">Resilience</div>
      <h2>DEGRADATION<br>AUTOMATON</h2>
      <p class="s-desc">D0→D3 state machine with psutil CPU/RAM monitoring, hysteresis (2 bad ticks to escalate, 4 good
        ticks to recover). Every transition emits a TraceEvent.</p>

      <div class="dg-layout">
        <div class="dg-states">
          <div class="dg-state d0 active" onclick="showDeg(this,0)">
            <div class="dg-lbl">D0</div>
            <div class="dg-info">
              <div class="dg-name">Full Operation</div>
              <div class="dg-trigger">CPU &lt;50% · RAM &lt;60%</div>
            </div>
          </div>
          <div class="dg-state d1" onclick="showDeg(this,1)">
            <div class="dg-lbl">D1</div>
            <div class="dg-info">
              <div class="dg-name">Reduced Intelligence</div>
              <div class="dg-trigger">CPU 50–80% · RAM 60–85%</div>
            </div>
          </div>
          <div class="dg-state d2" onclick="showDeg(this,2)">
            <div class="dg-lbl">D2</div>
            <div class="dg-info">
              <div class="dg-name">Minimal / Strict</div>
              <div class="dg-trigger">CPU 80–95% · RAM 85–95%</div>
            </div>
          </div>
          <div class="dg-state d3" onclick="showDeg(this,3)">
            <div class="dg-lbl">D3</div>
            <div class="dg-info">
              <div class="dg-name">Critical / Load Shed</div>
              <div class="dg-trigger">CPU &gt;95% · RAM &gt;95%</div>
            </div>
          </div>
        </div>
        <div class="dg-detail" id="dgDetail"></div>
      </div>
    </div>
  </section>

  <hr class="section-divider">

  <!-- COMPARISON -->
  <section id="comparison">
    <div class="container">
      <div class="s-tag">Positioning</div>
      <h2>WHY OSP,<br>NOT X</h2>
      <p class="s-desc">MCP handles tool discovery. A2A handles agent-to-agent communication. OSP fills the gap: full
        skill lifecycle inside multi-persona systems.</p>

      <table class="cmp-table">
        <thead>
          <tr>
            <th>Capability</th>
            <th>MCP</th>
            <th>OpenAI Tools</th>
            <th>LangChain</th>
            <th>A2A Google</th>
            <th class="osp-th">OSP ←</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Multi-persona skill routing</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="prt">Partial</td>
            <td class="crs">—</td>
            <td class="chk osp-td">✓ Core</td>
          </tr>
          <tr>
            <td>Safety tiering (LOW/MED/HIGH)</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="chk osp-td">✓ 3-layer</td>
          </tr>
          <tr>
            <td>Graceful degradation (D0→D3)</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="chk osp-td">✓ psutil FSM</td>
          </tr>
          <tr>
            <td>Deterministic routing contract</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="chk osp-td">✓ IEEE 754</td>
          </tr>
          <tr>
            <td>Cryptographic response signing</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="chk osp-td">✓ JCS+ES256</td>
          </tr>
          <tr>
            <td>Conformance test suite (YAML)</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="chk osp-td">✓ 18+ vectors</td>
          </tr>
          <tr>
            <td>Skill lifecycle governance</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="chk osp-td">✓ LifecycleGates</td>
          </tr>
          <tr>
            <td>Keyword activation tuning</td>
            <td class="crs">—</td>
            <td class="prt">Partial</td>
            <td class="prt">Partial</td>
            <td class="crs">—</td>
            <td class="chk osp-td">✓ Configurable</td>
          </tr>
          <tr>
            <td>Tool/resource discovery</td>
            <td class="chk">✓</td>
            <td class="chk">✓</td>
            <td class="prt">Partial</td>
            <td class="crs">—</td>
            <td class="osp-td" style="color:var(--muted)">→ use MCP</td>
          </tr>
          <tr>
            <td>Agent-to-agent communication</td>
            <td class="crs">—</td>
            <td class="crs">—</td>
            <td class="prt">Partial</td>
            <td class="chk">✓</td>
            <td class="osp-td" style="color:var(--muted)">→ use A2A</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <hr class="section-divider">

  <!-- SKILLS MARKETPLACE -->
  <section id="skills">
    <div class="container">
      <div class="s-tag">Skills Registry</div>
      <h2>BUILT-IN<br>SKILL CATALOG</h2>
      <p class="s-desc">Production skills from the ASP reference implementation. Each skill is a metadata.yaml
        conforming to the OSP L0 Catalog-Lite Record specification.</p>

      <div class="skills-grid">
        <div class="sk-card">
          <div class="sk-scope">foundation</div>
          <div class="sk-name">Content Summarizer</div>
          <div class="sk-id">org.osp.foundation.summarize@1.0.0</div>
          <div class="sk-desc">Summarizes text, articles, or audio files into concise bullet points. Configurable output
            language via parameters.</div>
          <div class="sk-meta">
            <span class="r-low">LOW</span>
            <span class="sk-strat">hybrid</span>
            <span class="sk-keywords">summarize, summary, report</span>
          </div>
        </div>
        <div class="sk-card">
          <div class="sk-scope">integrations · google</div>
          <div class="sk-name">YouTube Analyzer</div>
          <div class="sk-id">org.antigravity.youtube.analyzer@1.0.0</div>
          <div class="sk-desc">Extracts transcripts and provides summaries of YouTube videos by URL or video_id
            parameter.</div>
          <div class="sk-meta">
            <span class="r-low">LOW</span>
            <span class="sk-strat">hybrid</span>
            <span class="sk-keywords">analyze, youtube, transcript</span>
          </div>
        </div>
        <div class="sk-card">
          <div class="sk-scope">integrations · google</div>
          <div class="sk-name">Google Drive</div>
          <div class="sk-id">org.antigravity.google.drive@1.0.0</div>
          <div class="sk-desc">List and search files in Google Drive. Supports complex query strings matching Google
            Drive API syntax.</div>
          <div class="sk-meta">
            <span class="r-low">LOW</span>
            <span class="sk-strat">hybrid</span>
            <span class="sk-keywords">list, file, drive, search, find</span>
          </div>
        </div>
        <div class="sk-card">
          <div class="sk-scope">integrations · google</div>
          <div class="sk-name">Invoice Search</div>
          <div class="sk-id">org.antigravity.google.search_invoices@1.0.0</div>
          <div class="sk-desc">Search and retrieve invoices from Google Drive with structured metadata extraction.</div>
          <div class="sk-meta">
            <span class="r-low">LOW</span>
            <span class="sk-strat">hybrid</span>
            <span class="sk-keywords">invoice, receipt, payment</span>
          </div>
        </div>
        <div class="sk-card">
          <div class="sk-scope">integrations · telegram</div>
          <div class="sk-name">Telegram Agent</div>
          <div class="sk-id">org.antigravity.telegram@1.0.0</div>
          <div class="sk-desc">Send messages and interact with Telegram chats and channels programmatically.</div>
          <div class="sk-meta">
            <span class="r-med">MED</span>
            <span class="sk-strat">hybrid</span>
            <span class="sk-keywords">telegram, send, message</span>
          </div>
        </div>
        <div class="sk-card" style="border:1px dashed var(--border);background:var(--bg)">
          <div class="sk-scope" style="color:var(--dim)">contribute</div>
          <div class="sk-name" style="color:var(--dim)">Add Your Skill</div>
          <div class="sk-id" style="color:var(--dim)">org.yourname.skill@x.y.z</div>
          <div class="sk-desc" style="color:var(--dim)">Create metadata.yaml following L0 Record spec. Submit PR to
            open-skills-protocol/registry.</div>
          <div class="sk-meta">
            <span style="font-family:var(--mono);font-size:11px;color:var(--amber)">→ osp new skill my-skill</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <hr class="section-divider">

  <!-- CLI -->
  <section id="cli">
    <div class="container">
      <div class="s-tag">Developer Tools</div>
      <h2>OSP CLI</h2>
      <p class="s-desc">Scaffold skills, run conformance checks, validate manifests, and monitor your deployment from
        the terminal.</p>

      <div class="cli-grid">
        <div class="cli-commands">
          <div class="cli-cmd">
            <div class="cli-cmd-text">osp new skill &lt;name&gt;</div>
            <div class="cli-cmd-sep">→</div>
            <div class="cli-cmd-desc">Scaffold metadata.yaml + scripts/tools.py + skill.md in seconds</div>
          </div>
          <div class="cli-cmd">
            <div class="cli-cmd-text">osp new agent &lt;name&gt;</div>
            <div class="cli-cmd-sep">→</div>
            <div class="cli-cmd-desc">Create agent.yaml with skill dependencies and model config</div>
          </div>
          <div class="cli-cmd">
            <div class="cli-cmd-text">osp check</div>
            <div class="cli-cmd-sep">→</div>
            <div class="cli-cmd-desc">Run OSP Core conformance suite (20 routing + 5 negative tests)</div>
          </div>
          <div class="cli-cmd">
            <div class="cli-cmd-text">osp check --level safety</div>
            <div class="cli-cmd-sep">→</div>
            <div class="cli-cmd-desc">Safety tier: +10 safety cases, +5 adversarial samples</div>
          </div>
          <div class="cli-cmd">
            <div class="cli-cmd-text">osp manifest validate</div>
            <div class="cli-cmd-sep">→</div>
            <div class="cli-cmd-desc">Validate metadata.yaml against OSP L0 Record JSON Schema</div>
          </div>
          <div class="cli-cmd">
            <div class="cli-cmd-text">asp dev hello.py</div>
            <div class="cli-cmd-sep">→</div>
            <div class="cli-cmd-desc">Start ASP server in dev mode with hot reload + dashboard at /_dashboard</div>
          </div>
        </div>

        <div class="cli-demo">
          <div class="cw-header">
            <div class="cw-dots">
              <div class="cw-dot cw-dot-r"></div>
              <div class="cw-dot cw-dot-y"></div>
              <div class="cw-dot cw-dot-g"></div>
            </div>
            <span class="cw-fname">terminal · osp check output</span>
          </div>
          <div class="terminal-body">
            <div><span class="t-prompt">$ </span><span class="t-cmd">osp check --level core</span></div>
            <div>&nbsp;</div>
            <div><span class="t-info">══════════════════════════════════════════</span></div>
            <div><span class="t-info"> OSP Conformance Harness — 18 tests</span></div>
            <div><span class="t-info">══════════════════════════════════════════</span></div>
            <div>&nbsp;</div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[RT-001] Basic Lexical Routing</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[RT-002] Empty Query Rejection</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[RT-003] Empty Pool Escalation</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[RT-004] Escape Hatch Override</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[RT-005] BM25 Best Match — got:
                org.test.weather</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[RT-006] Skip Semantic Condition</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[RT-007] Trace Events Present</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[RT-008] IEEE 754 Epsilon</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[SAF-001] SQL Injection Blocked</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[SAF-002] Command Injection Blocked</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[SAF-003] Safe Query Passes</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[SAF-004] Violence Detection</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[SAF-005] KL-Divergence Zero for Identical</span>
            </div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[DEG-001–004] D0/D1/D2/D3 States</span></div>
            <div><span class="t-ok"> ✓</span> <span class="t-dim">[MDL-001–004] Pydantic Models</span></div>
            <div><span class="t-fail"> ✗</span> <span class="t-dim">[MDL-001] Pydantic Models — pydantic not
                installed</span></div>
            <div>&nbsp;</div>
            <div><span class="t-info">──────────────────────────────────────────</span></div>
            <div><span class="t-ok"> ✅ Passed: 17</span> <span class="t-fail">❌ Failed: 1</span> <span
                class="t-dim">Total: 18</span></div>
            <div><span class="t-info"> Score: 17/18 (94.4%) · OSP Core level</span></div>
            <div><span class="t-dim"> 📄 Report: conformance_report.json</span></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <hr class="section-divider">

  <!-- ERROR TAXONOMY -->
  <section id="errors">
    <div class="container">
      <div class="s-tag">Error Taxonomy</div>
      <h2>CANONICAL<br>TRACE EVENTS</h2>
      <p class="s-desc">Every routing decision, safety block, and degradation transition emits a structured TraceEvent.
        All codes from the reference implementation.</p>

      <table class="error-table">
        <thead>
          <tr>
            <th>Code</th>
            <th>Stage</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>ROUTING_DECISION_FINAL</td>
            <td>3</td>
            <td>Routing resolved successfully. skill_ref is set.</td>
          </tr>
          <tr>
            <td>STAGE1_LEXICAL_MATCH</td>
            <td>1</td>
            <td>BM25 scoring completed. context includes latency_ms.</td>
          </tr>
          <tr>
            <td>STAGE1_IDENTICAL_SCORES</td>
            <td>1</td>
            <td>Multiple candidates share identical BM25 score. Stage 2 required.</td>
          </tr>
          <tr>
            <td>STAGE1_NO_MATCHES</td>
            <td>1</td>
            <td>All BM25 scores are 0. Fallback to first candidate with approximate=true.</td>
          </tr>
          <tr>
            <td>STAGE2_EMBEDDING_GENERATED</td>
            <td>2</td>
            <td>Batch encoding successful. Cosine similarity computed.</td>
          </tr>
          <tr>
            <td>STAGE2_EMBEDDING_TIMEOUT</td>
            <td>2</td>
            <td>Sentence-transformer timed out. Falls back to BM25-only ranking.</td>
          </tr>
          <tr>
            <td>STAGE2_SEMANTIC_THRESHOLD_MET</td>
            <td>2</td>
            <td>Best semantic score ≥ 0.7. High confidence routing.</td>
          </tr>
          <tr>
            <td>ANN_APPROXIMATE_RECALL</td>
            <td>2</td>
            <td>ANN backend used. recall_unknown: true if offline eval unavailable.</td>
          </tr>
          <tr>
            <td>STAGE3_CONFLICT_DETECTED</td>
            <td>3</td>
            <td>Tied combined scores detected. Tiebreak procedure initiated.</td>
          </tr>
          <tr>
            <td>STAGE3_TIE_BREAK_SKILL_ID</td>
            <td>3</td>
            <td>UTF-8 lexicographic tiebreak applied. tie_break_applied: true.</td>
          </tr>
          <tr>
            <td>CONFLICT_GRAPH_UNAVAILABLE</td>
            <td>3</td>
            <td>Conflict graph offline. Canonical fallback chain used.</td>
          </tr>
          <tr>
            <td>SAFETY_CHECK_PASS</td>
            <td>safety</td>
            <td>All 3 safety layers passed. Routing proceeds.</td>
          </tr>
          <tr>
            <td>PREFILTER_SQL_INJECTION</td>
            <td>safety</td>
            <td>SQL injection pattern detected. refusal: true.</td>
          </tr>
          <tr>
            <td>SEMANTIC_JAILBREAK_ATTEMPT</td>
            <td>safety</td>
            <td>TF-IDF classifier matched JAILBREAK category. Blocked.</td>
          </tr>
          <tr>
            <td>ANOMALY_DETECTED</td>
            <td>safety</td>
            <td>KL-divergence &gt; 0.5. Distribution shift detected.</td>
          </tr>
          <tr>
            <td>FAIL_CLOSED_TRIGGERED</td>
            <td>safety</td>
            <td>Classifier threw exception. Fail-closed: request blocked.</td>
          </tr>
          <tr>
            <td>DEGRADE_TRANSITION</td>
            <td>degradation</td>
            <td>D-state changed. from/to included in context.</td>
          </tr>
          <tr>
            <td>SAFE_FALLBACK_SERVED</td>
            <td>fallback</td>
            <td>D3 active or routing failed. SafeFallbackResponse returned.</td>
          </tr>
          <tr>
            <td>ROUTING_POOL_EMPTY</td>
            <td>1</td>
            <td>No candidate skills provided. safety_clearance: escalate.</td>
          </tr>
          <tr>
            <td>CACHE_HIT</td>
            <td>0</td>
            <td>LRU cache hit. Identical query+candidates routed from cache.</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <hr class="section-divider">

  <!-- CONFORMANCE -->
  <section id="conform">
    <div class="container">
      <div class="s-tag">Conformance</div>
      <h2>FOUR LEVELS,<br>ONE SUITE</h2>
      <p class="s-desc">Conformance is defined by passing official YAML test vectors — not self-attestation. Current
        status: ASP reference implementation 17/18 (94.4%).</p>

      <div class="conf-grid">
        <div class="conf-card">
          <div class="conf-lv lv-core">OSP Core</div>
          <div class="conf-name">Core</div>
          <div class="conf-tests">
            <div class="ct-row"><span class="ct-name">Routing vectors</span><span class="ct-num">20</span></div>
            <div class="ct-row"><span class="ct-name">Negative tests</span><span class="ct-num">5</span></div>
            <div class="ct-row"><span class="ct-name">Safety cases</span><span class="ct-num">—</span></div>
            <div class="ct-row"><span class="ct-name">Degrade drills</span><span class="ct-num">—</span></div>
            <div class="ct-row"><span class="ct-name">Adversarial</span><span class="ct-num">—</span></div>
          </div>
          <div class="badge-prev">
            <div class="bp-dot bpd-core"></div>OSP Core Conformant
          </div>
        </div>
        <div class="conf-card">
          <div class="conf-lv lv-safety">OSP Safety</div>
          <div class="conf-name">Safety</div>
          <div class="conf-tests">
            <div class="ct-row"><span class="ct-name">Routing vectors</span><span class="ct-num">20</span></div>
            <div class="ct-row"><span class="ct-name">Negative tests</span><span class="ct-num">8</span></div>
            <div class="ct-row"><span class="ct-name">Safety cases</span><span class="ct-num">10</span></div>
            <div class="ct-row"><span class="ct-name">Degrade drills</span><span class="ct-num">—</span></div>
            <div class="ct-row"><span class="ct-name">Adversarial</span><span class="ct-num">5</span></div>
          </div>
          <div class="badge-prev">
            <div class="bp-dot bpd-safety"></div>OSP Safety Conformant
          </div>
        </div>
        <div class="conf-card">
          <div class="conf-lv lv-resilience">OSP Resilience</div>
          <div class="conf-name">Resilience</div>
          <div class="conf-tests">
            <div class="ct-row"><span class="ct-name">Routing vectors</span><span class="ct-num">20</span></div>
            <div class="ct-row"><span class="ct-name">Negative tests</span><span class="ct-num">10</span></div>
            <div class="ct-row"><span class="ct-name">Safety cases</span><span class="ct-num">10</span></div>
            <div class="ct-row"><span class="ct-name">Degrade drills</span><span class="ct-num">15</span></div>
            <div class="ct-row"><span class="ct-name">Adversarial</span><span class="ct-num">5</span></div>
          </div>
          <div class="badge-prev">
            <div class="bp-dot bpd-resilience"></div>OSP Resilience Conformant
          </div>
        </div>
        <div class="conf-card">
          <div class="conf-lv lv-enterprise">OSP Enterprise</div>
          <div class="conf-name">Enterprise</div>
          <div class="conf-tests">
            <div class="ct-row"><span class="ct-name">Routing vectors</span><span class="ct-num">50</span></div>
            <div class="ct-row"><span class="ct-name">Negative tests</span><span class="ct-num">15</span></div>
            <div class="ct-row"><span class="ct-name">Safety cases</span><span class="ct-num">20</span></div>
            <div class="ct-row"><span class="ct-name">Degrade drills</span><span class="ct-num">15</span></div>
            <div class="ct-row"><span class="ct-name">Adversarial</span><span class="ct-num">10</span></div>
          </div>
          <div class="badge-prev">
            <div class="bp-dot bpd-enterprise"></div>OSP Enterprise Conformant
          </div>
        </div>
      </div>

      <div class="conf-status-row">
        <div class="cs-label">ASP reference impl · last run 2h ago ·</div>
        <div class="cs-result"><span class="pulse"></span> 17 passing</div>
        <div class="cs-sep">·</div>
        <div class="cs-fail">1 failing — pydantic not in env</div>
        <div class="cs-sep">·</div>
        <div class="cs-label">Level claimed: <strong style="color:var(--text)">OSP Resilience</strong></div>
      </div>
    </div>
  </section>

  <hr class="section-divider">

  <!-- STATUS -->
  <section id="status">
    <div class="container">
      <div class="s-tag">Live Production</div>
      <h2>ASP IN<br>PRODUCTION</h2>
      <p class="s-desc">Real-time metrics from the AMADEQ reference implementation. OSP proven at scale: 1,500+ avatars,
        24/7 operation across multiple markets.</p>

      <div class="status-grid">
        <div class="stat-card">
          <div class="sc-head">
            <div class="sc-title">Uptime · Last 90 Days</div>
            <div class="sc-live"><span class="pulse"></span>LIVE</div>
          </div>
          <div class="uptime-strip" id="uptimeStrip"></div>
          <div class="uptime-big">99.97<span style="font-size:20px;color:var(--muted)">%</span></div>
          <div class="uptime-sub">2 incidents · Total downtime: 26 min</div>
        </div>

        <div class="stat-card">
          <div class="sc-head">
            <div class="sc-title">Live Routing Feed</div>
            <div class="sc-live"><span class="pulse"></span>LIVE</div>
          </div>
          <div class="feed-list" id="feedList"></div>
        </div>

        <div class="metrics-strip">
          <div class="ms-card">
            <div class="ms-val" id="mRouting">—</div>
            <div class="ms-lbl">Routing decisions today</div>
          </div>
          <div class="ms-card">
            <div class="ms-val" id="mSafety">—</div>
            <div class="ms-lbl">Safety blocks today</div>
          </div>
          <div class="ms-card">
            <div class="ms-val" data-count="847">0</div>
            <div class="ms-lbl">Active skills in registry</div>
          </div>
          <div class="ms-card">
            <div class="ms-val" data-count="1500" data-suffix="+">0</div>
            <div class="ms-lbl">AI avatars served</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <hr class="section-divider">

  <!-- ADOPT -->
  <section id="adopt">
    <div class="container">
      <div class="s-tag">Adopt OSP</div>
      <h2>FROM SPEC<br>TO BADGE</h2>
      <p class="s-desc">Estimated 4–8 hours for an experienced team to reach OSP Core conformance. No vendor lock-in. No
        API keys. Pure open standard.</p>

      <div class="adopt-steps">
        <div class="as-step">
          <div class="as-num">01</div>
          <div class="as-title">Read osp-core-spec.md</div>
          <div class="as-desc">Vendor-neutral specification. Zero implementation-specific references. Understand the
            4-stage routing contract and D0–D3 automaton.</div>
          <div class="as-time">~15 min read</div>
        </div>
        <div class="as-step">
          <div class="as-num">02</div>
          <div class="as-title">Implement Schemas</div>
          <div class="as-desc">SkillManifest + RoutingDecision + TraceEvent + SafetyDecision. Any language. Any
            framework. Pydantic models available as reference.</div>
          <div class="as-time">~2–4h for core</div>
        </div>
        <div class="as-step">
          <div class="as-num">03</div>
          <div class="as-title">Run Conformance</div>
          <div class="as-desc">osp check — runs 20 routing vectors + 5 negative tests. Produces JSON report. Tests are
            YAML-defined, language-agnostic.</div>
          <div class="as-time">~1h for Core level</div>
        </div>
        <div class="as-step">
          <div class="as-num">04</div>
          <div class="as-title">Submit & Display Badge</div>
          <div class="as-desc">Open PR with conformance_report.json. Pass → join Adopters list + display your level
            badge in your README.</div>
          <div class="as-time">Community review 48h</div>
        </div>
      </div>

      <div class="adopters-box">
        <div class="ab-header">
          <div class="ab-title">OSP Adopters</div>
          <div class="ab-count">1 independent · v0.3.x · growing</div>
        </div>
        <div class="adopters-row">
          <div class="adopter">
            <div class="adopter-name">AMADEQ (ASP)</div>
            <div class="adopter-stack">Python · sentence-transformers · Qdrant · RTX 5090</div>
            <span class="adopter-badge">OSP Resilience · Reference Impl · 17/18</span>
          </div>
          <div class="be-first-card">
            <div class="bfc-inner">
              <div class="bfc-plus">+</div>
              <div class="bfc-text">Your implementation here<br><span>osp check → open a PR →</span></div>
            </div>
          </div>
          <div class="be-first-card">
            <div class="bfc-inner">
              <div class="bfc-plus">+</div>
              <div class="bfc-text">Second independent impl<br><span>Needed for Working Group formation</span></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="footer-brand">
      <div class="osp-mark-lg">OSP</div>
      <p>Open Skills Protocol · v0.3.2 · Draft for Community Review · Feb 2026</p>
      <p style="margin-top:4px">Originated by AMADEQ Project · Governed by community · openskillsprotocol.dev</p>
    </div>
    <div class="footer-links">
      <a href="#">Specification</a>
      <a href="#">GitHub</a>
      <a href="#">Conformance</a>
      <a href="#">Skills Registry</a>
      <a href="#">Working Group</a>
      <a href="#">Changelog</a>
      <a href="#">AMADEQ.org →</a>
    </div>
    <div class="footer-lic">
      Apache 2.0 (spec) · CC BY 4.0 (docs)<br>
      <span style="color:var(--dim)">No single vendor holds veto power</span>
    </div>
  </footer>

  <!-- BACK TO TOP -->
  <button class="back-to-top" id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})"
    aria-label="Back to top">↑</button>

  <script>
    // ── INSTALL TABS ──
    function switchInstall(btn, id) {
      document.querySelectorAll('.itab').forEach(b => b.classList.remove('active'));
      document.querySelectorAll('.install-code').forEach(c => c.classList.remove('active'));
      btn.classList.add('active');
      document.getElementById('install-' + id).classList.add('active');
    }

    // ── LANG TABS ──
    function switchLang(btn, id) {
      btn.closest('.code-window').querySelectorAll('.ltab').forEach(b => b.classList.remove('active'));
      btn.closest('.code-window').querySelectorAll('.cw-body').forEach(c => c.classList.remove('active'));
      btn.classList.add('active');
      document.getElementById('lang-' + id).classList.add('active');
    }

    // ── QUERY CHIPS ──
    function pickChip(el, text) {
      document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
      el.classList.add('active');
      document.getElementById('qinput').value = text;
    }

    // ── CONFORMANCE FILL ──
    setTimeout(() => { document.getElementById('confFill').style.width = '94.4%' }, 400);

    // ── ROUTING PLAYGROUND DATA ──
    const DB = {
      'Say hi to Alex': {
        skill: 'greet@2.1.0', risk: 'LOW', score: '0.94', stability: 'semantic_supported',
        steps: [
          { name: 'SAFETY CHECK', ms: '0.01ms', detail: '<span class="hl">Regex prefilter:</span> <span class="val">PASS</span> · <span class="hl">TF-IDF classifier:</span> <span class="val">SAFE</span> · SAFETY_CHECK_PASS' },
          { name: 'STAGE 0 · FILTER', ms: '0.3ms', detail: 'L0 catalog scan: <span class="hl">6 skills</span> → <span class="val">6 candidates</span> · No capability restrictions' },
          { name: 'STAGE 1 · SCORE (BM25)', ms: '0.8ms', detail: 'Keywords match: <span class="hl">hello, greet, hi</span> → BM25: <span class="sc">0.94</span> · STAGE1_LEXICAL_MATCH' },
          { name: 'STAGE 2 · RERANK (Cosine)', ms: '1.1ms', detail: 'Batch encode: 7 texts · Cosine: <span class="sc">0.91</span> · Combined: <span class="sc">0.4×BM25 + 0.6×Sem = 0.922</span>' },
          { name: 'STAGE 3 · RESOLVE', ms: '0.2ms', detail: 'No conflicts · decision_stability: <span class="val">semantic_supported</span> · ROUTING_DECISION_FINAL' },
        ]
      },
      'Math homework help': {
        skill: 'math-tutor@3.0.1', risk: 'LOW', score: '0.91', stability: 'semantic_supported',
        steps: [
          { name: 'SAFETY CHECK', ms: '0.01ms', detail: 'All layers PASS · SAFETY_CHECK_PASS' },
          { name: 'STAGE 0 · FILTER', ms: '0.3ms', detail: '6 skills → <span class="val">5 candidates</span> · crisis-support: CRISIS context required → excluded' },
          { name: 'STAGE 1 · SCORE (BM25)', ms: '0.9ms', detail: 'Keywords: <span class="hl">math, homework</span> → BM25: <span class="sc">0.91</span> · STAGE1_LEXICAL_MATCH' },
          { name: 'STAGE 2 · RERANK (Cosine)', ms: '1.3ms', detail: 'Cosine: <span class="sc">0.88</span> · Combined score: <span class="sc">0.892</span> · ANN_APPROXIMATE_RECALL: false' },
          { name: 'STAGE 3 · RESOLVE', ms: '0.2ms', detail: 'No conflicts · ROUTING_DECISION_FINAL' },
        ]
      },
      'I feel anxious today': {
        skill: 'psych-counsel@1.4.0', risk: 'MED', score: '0.87', stability: 'approximate_match',
        steps: [
          { name: 'SAFETY CHECK', ms: '0.8ms', detail: '<span class="hl">TF-IDF:</span> INTERNAL_STATE score 0.12 (below 0.15 threshold) → <span class="val">PASS</span> · SAFETY_CHECK_PASS' },
          { name: 'STAGE 0 · FILTER', ms: '0.4ms', detail: '6 skills → <span class="val">3 candidates</span> · Emotional context detected' },
          { name: 'STAGE 1 · SCORE (BM25)', ms: '1.2ms', detail: 'Keywords: <span class="hl">anxious, feel</span> → BM25: <span class="sc">0.87</span> · STAGE1_IDENTICAL_SCORES: crisis-support tied' },
          { name: 'STAGE 2 · RERANK (Cosine)', ms: '2.1ms', detail: 'MEDIUM risk → deeper rerank · Cosine: psych-counsel <span class="sc">0.82</span> vs crisis-support <span class="sc">0.61</span>' },
          { name: 'STAGE 3 · RESOLVE', ms: '0.3ms', detail: 'STAGE3_LOWER_RISK_SELECTED · psych over crisis (MEDIUM < HIGH) · ROUTING_DECISION_FINAL' },
        ]
      },
      'Analyze this YouTube video': {
        skill: 'youtube.analyzer@1.0.0', risk: 'LOW', score: '0.93', stability: 'semantic_supported',
        steps: [
          { name: 'SAFETY CHECK', ms: '0.01ms', detail: 'All layers PASS · SAFETY_CHECK_PASS' },
          { name: 'STAGE 0 · FILTER', ms: '0.3ms', detail: '6 skills → <span class="val">5 candidates</span>' },
          { name: 'STAGE 1 · SCORE (BM25)', ms: '0.7ms', detail: 'Keywords: <span class="hl">analyze, youtube, video, transcript</span> → BM25: <span class="sc">0.93</span>' },
          { name: 'STAGE 2 · RERANK (Cosine)', ms: '1.0ms', detail: 'STAGE1 escape hatch → early Stage 2 promotion · Cosine: <span class="sc">0.91</span>' },
          { name: 'STAGE 3 · RESOLVE', ms: '0.2ms', detail: 'No conflicts · ROUTING_DECISION_FINAL' },
        ]
      },
      'Find files in my drive': {
        skill: 'google.drive@1.0.0', risk: 'LOW', score: '0.89', stability: 'semantic_supported',
        steps: [
          { name: 'SAFETY CHECK', ms: '0.01ms', detail: 'All layers PASS · SAFETY_CHECK_PASS' },
          { name: 'STAGE 0 · FILTER', ms: '0.3ms', detail: '6 skills → <span class="val">5 candidates</span>' },
          { name: 'STAGE 1 · SCORE (BM25)', ms: '0.8ms', detail: 'Keywords: <span class="hl">find, file, drive, search</span> → BM25: <span class="sc">0.89</span>' },
          { name: 'STAGE 2 · RERANK (Cosine)', ms: '1.2ms', detail: 'Combined: <span class="sc">0.4×0.89_norm + 0.6×0.86 = 0.872</span>' },
          { name: 'STAGE 3 · RESOLVE', ms: '0.2ms', detail: 'No conflicts · ROUTING_DECISION_FINAL' },
        ]
      },
      'UNION SELECT password FROM users': {
        skill: null, risk: 'HIGH', score: '—', stability: 'blocked',
        blocked: true,
        steps: [
          { name: 'SAFETY CHECK · LAYER 1', ms: '0.01ms', detail: '<span class="err">PREFILTER MATCH</span> · Pattern: <span class="err">sql_keywords</span> · Regex: UNION\\s+SELECT matched · BLOCK_ACTION' },
        ]
      }
    };

    const delay = ms => new Promise(r => setTimeout(r, ms));

    // ── LIVE API ──
    const API_BASE = 'https://api.amadeq.org';
    const PLAYGROUND_SESSION = 'osp-pg-' + Math.random().toString(36).slice(2, 8);

    // ── NAV STATUS ──
    function setNavStatus(state) {
      const el = document.querySelector('.nav-status');
      if (!el) return;
      if (state === 'online') {
        el.style.cssText = 'display:flex;align-items:center;gap:6px;font-family:var(--mono);font-size:11px;color:var(--green);background:var(--green-dim);border:1px solid rgba(57,255,136,0.2);padding:3px 10px;border-radius:2px';
        el.innerHTML = '<div class="pulse" style="background:var(--green)"></div> ONLINE';
      } else if (state === 'degraded') {
        el.style.cssText = 'display:flex;align-items:center;gap:6px;font-family:var(--mono);font-size:11px;color:var(--amber);background:var(--amber-dim);border:1px solid rgba(255,200,50,0.2);padding:3px 10px;border-radius:2px';
        el.innerHTML = '<div class="pulse" style="background:var(--amber)"></div> DEGRADED';
      }
    }

    async function checkApiHealth() {
      try {
        const ctrl = new AbortController();
        setTimeout(() => ctrl.abort(), 4000);
        const r = await fetch(API_BASE + '/api/chat', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message: 'ping', session_id: 'health-check' }),
          signal: ctrl.signal
        });
        setNavStatus(r.ok ? 'online' : 'degraded');
      } catch { setNavStatus('degraded'); }
    }
    checkApiHealth();
    setInterval(checkApiHealth, 30000);

    // ── LIVE ROUTE CALL ──
    async function fetchLiveRoute(query) {
      try {
        const ctrl = new AbortController();
        setTimeout(() => ctrl.abort(), 8000);
        const r = await fetch(API_BASE + '/api/chat', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message: query, session_id: PLAYGROUND_SESSION }),
          signal: ctrl.signal
        });
        if (r.ok) {
          const json = await r.json();
          return json.agent_response || null;
        }
      } catch { /* graceful fallback */ }
      return null;
    }

    // ── ROUTING PLAYGROUND ──
    async function runRoute() {
      const q = document.getElementById('qinput').value.trim();
      if (!q) return;
      const btn = document.getElementById('runBtn');
      const bar = document.getElementById('runProgress');
      btn.disabled = true;
      btn.classList.add('running');
      bar.style.width = '0%';
      const pane = document.getElementById('pgOutput');
      pane.innerHTML = '';

      const data = DB[q] || {
        skill: 'greet@2.1.0', risk: 'LOW', score: '0.72', stability: 'approximate_match',
        steps: [
          { name: 'SAFETY CHECK', ms: '0.01ms', detail: 'All layers PASS' },
          { name: 'STAGE 0-3 PIPELINE', ms: '2.1ms', detail: 'BM25 scored, semantic reranked, resolved · ROUTING_DECISION_FINAL' },
        ]
      };

      const livePromise = data.blocked ? Promise.resolve(null) : fetchLiveRoute(q);

      const wrap = document.createElement('div');
      pane.appendChild(wrap);
      const totalSteps = data.steps.length + 1;

      for (let i = 0; i < data.steps.length; i++) {
        bar.style.width = Math.round(((i + 1) / totalSteps) * 100) + '%';
        await delay(320);
        const s = data.steps[i];
        const el = document.createElement('div');
        el.className = 'pstep';
        const isLast = i === data.steps.length - 1;
        const dotCls = (data.blocked && i === 0) ? 'err' : 'ok';
        el.innerHTML = '<div class="pstep-track"><div class="psdot ' + dotCls + '"></div>' +
          (!isLast ? '<div class="psline"></div>' : '') + '</div>' +
          '<div class="pstep-body"><div class="pstep-head"><div class="pstep-name">' + s.name + '</div>' +
          '<div class="pstep-ms">' + s.ms + '</div></div>' +
          '<div class="pstep-detail">' + s.detail + '</div></div>';
        wrap.appendChild(el);
        await delay(20);
        el.classList.add('show');
      }

      bar.style.width = '100%';
      await delay(300);
      const liveResponse = await livePromise;
      const rc = document.createElement('div');
      rc.className = 'result-card';

      // Build trace data for expandable view
      const traceLines = data.steps.map(s =>
        '<span class="tk">' + s.name + '</span> <span class="tv">' + s.ms + '</span> — ' + s.detail
      ).join('<br>');
      const traceHtml = '<div class="rc-trace-toggle" onclick="this.nextElementSibling.classList.toggle(\'open\');this.textContent=this.nextElementSibling.classList.contains(\'open\')?\'▲ Hide Trace\':\'▼ Show Full Trace\'">▼ Show Full Trace</div>' +
        '<div class="rc-trace-body">' + traceLines + '</div>';

      if (data.blocked) {
        rc.style.borderColor = 'rgba(255,77,106,0.3)';
        rc.innerHTML = '<div class="rc-label" style="color:var(--red)">✗ BLOCKED — SAFE_FALLBACK_SERVED</div>' +
          '<div class="rc-skill" style="color:var(--red)">refusal: true</div>' +
          '<div class="rc-tags"><div class="rc-tag" style="color:var(--red);border-color:rgba(255,77,106,0.3)">PREFILTER_SQL_INJECTION</div>' +
          '<div class="rc-tag">Signed: ES256</div></div>' + traceHtml;
      } else {
        const rcColor = data.risk === 'LOW' ? 'var(--green)' : data.risk === 'MED' ? 'var(--amber)' : 'var(--red)';
        const preview = liveResponse ? liveResponse.slice(0, 120) + (liveResponse.length > 120 ? '…' : '') : '';
        const liveTag = liveResponse
          ? '<div class="rc-tag" style="color:var(--green);border-color:rgba(57,255,136,0.3);margin-top:8px;width:100%;line-height:1.5">⚡ LIVE · ' + preview + '</div>'
          : '';
        rc.innerHTML = '<div class="rc-label">✓ ROUTING_DECISION_FINAL</div>' +
          '<div class="rc-skill">' + data.skill + '</div>' +
          '<div class="rc-tags">' +
          '<div class="rc-tag" style="color:' + rcColor + ';border-color:' + rcColor + '22">Risk: ' + data.risk + '</div>' +
          '<div class="rc-tag">Score: ' + data.score + '</div>' +
          '<div class="rc-tag">' + data.stability + '</div>' +
          '<div class="rc-tag">Signed: ES256</div>' +
          liveTag +
          '</div>' + traceHtml;
        if (liveResponse) pushFeedEntry({ skill: data.skill, score: data.score, ok: true, live: true });
      }

      pane.appendChild(rc);
      await delay(30);
      rc.classList.add('show');
      btn.disabled = false;
      btn.classList.remove('running');
      setTimeout(() => { bar.style.width = '0%'; }, 600);
    }

    // ── DEGRADATION STATES ──
    const DG = [
      {
        cls: 'dst-d0', badge: 'D0 — Full Operation',
        caps: [
          { ok: true, text: 'All 4 routing stages active' },
          { ok: true, text: 'Semantic embedding (Stage 2) enabled' },
          { ok: true, text: 'Full safety matrix (LOW/MED/HIGH)' },
          { ok: true, text: 'LLM calls permitted (should_use_llm: true)' },
          { ok: true, text: 'Sub-millisecond routing guaranteed' },
        ],
        trigger: 'Entry state. CPU &lt;50%, RAM &lt;60%. Monitored by psutil every 5s.',
        trace: '<span class="tc">ROUTING_COMPLETE</span> <span class="tv">{ D: 0, mode: "full" }</span>\n<span class="tc">SAFETY_CHECK_PASS</span> <span class="tv">{ latency_ms: 0.01 }</span>\n<span class="tc">DELIVERY_SIGNED</span> <span class="tv">{ alg: "ES256" }</span>'
      },
      {
        cls: 'dst-d1', badge: 'D1 — Reduced Intelligence',
        caps: [
          { ok: true, text: 'Stages 0, 1 online (BM25 routing)' },
          { ok: false, text: 'Stage 2 offline (no sentence-transformers)' },
          { ok: true, text: 'Full safety matrix active' },
          { ok: false, text: 'LLM calls blocked (should_use_llm: false)' },
          { ok: true, text: 'Core skill routing continues' },
        ],
        trigger: 'CPU 50–80% OR RAM 60–85%. Requires 2 consecutive bad ticks (hysteresis).',
        trace: '<span class="tc">DEGRADE_TRANSITION</span> <span class="tv">{ from: "D0", to: "D1" }</span>\n<span class="tc">ROUTING_DEGRADED</span> <span class="tv">{ mode: "lexical", D: 1 }</span>\n<span class="tc">STAGE2_SKIPPED</span> <span class="tv">{ reason: "D1_active" }</span>'
      },
      {
        cls: 'dst-d2', badge: 'D2 — Minimal / Strict',
        caps: [
          { ok: true, text: 'Stage 0 filter online' },
          { ok: false, text: 'Stage 1 classifier offline (is_strict_routing_only: true)' },
          { ok: false, text: 'Stage 2 embedding offline' },
          { ok: true, text: 'Exact keyword matching only' },
          { ok: true, text: 'Core LOW-risk skill subset only' },
        ],
        trigger: 'CPU 80–95% OR RAM 85–95%. Hysteresis prevents oscillation.',
        trace: '<span class="tc">DEGRADE_TRANSITION</span> <span class="tv">{ from: "D1", to: "D2" }</span>\n<span class="tc">ROUTING_DEGRADED</span> <span class="tv">{ mode: "keyword", D: 2 }</span>\n<span class="tc">STAGE1_SKIPPED</span> <span class="tv">{ reason: "strict_mode" }</span>'
      },
      {
        cls: 'dst-d3', badge: 'D3 — Critical / Load Shed',
        caps: [
          { ok: false, text: 'check_request_allowed() returns False' },
          { ok: false, text: 'All routing stages offline' },
          { ok: false, text: 'Catalog unavailable' },
          { ok: true, text: 'SafeFallbackResponse served (signed)' },
          { ok: true, text: 'TraceEvent emitted — never silent' },
        ],
        trigger: 'CPU &gt;95% OR RAM &gt;95%. Requires 2 ticks. Recovery requires 4 good ticks.',
        trace: '<span class="tc">DEGRADE_TRANSITION</span> <span class="tv">{ from: "D2", to: "D3" }</span>\n<span class="tc">SAFE_FALLBACK_SERVED</span> <span class="tv">{ signed: true, D: 3 }</span>\n<span class="tc">REQUEST_SHED</span> <span class="tv">{ reason: "D3_critical" }</span>'
      }
    ];

    function showDeg(el, idx) {
      document.querySelectorAll('.dg-state').forEach(s => s.classList.remove('active'));
      el.classList.add('active');
      renderDeg(idx);
    }

    function renderDeg(idx) {
      const d = DG[idx];
      document.getElementById('dgDetail').innerHTML =
        '<div class="dg-state-tag ' + d.cls + '">' + d.badge + '</div>' +
        '<div><div class="dg-sec-lbl">Available Capabilities</div>' +
        '<ul class="caps-list">' +
        d.caps.map(c =>
          '<li><span class="' + (c.ok ? 'cap-ok' : 'cap-no') + '">' + (c.ok ? '✓' : '✗') + '</span>' +
          '<span style="color:' + (c.ok ? 'var(--muted)' : 'var(--dim)') + ';margin-left:8px">' + c.text + '</span></li>'
        ).join('') +
        '</ul></div>' +
        '<div><div class="dg-sec-lbl">Transition Trigger</div>' +
        '<div style="font-size:13px;color:var(--muted)">' + d.trigger + '</div></div>' +
        '<div><div class="dg-sec-lbl">TraceEvents Emitted</div>' +
        '<div class="trace-block">' + d.trace + '</div></div>';
    }
    renderDeg(0);

    // ── UPTIME BAR ──
    const strip = document.getElementById('uptimeStrip');
    for (let i = 0; i < 90; i++) {
      const b = document.createElement('div');
      b.className = 'ub' + ([13, 48].includes(i) ? ' down' : '');
      strip.appendChild(b);
    }

    // ── LIVE FEED ──
    const FEED_DATA = [
      { skill: 'greet@2.1.0', score: '0.94', ok: true },
      { skill: 'math-tutor@3.0.1', score: '0.91', ok: true },
      { skill: 'psych-counsel@1.4.0', score: '0.87', ok: true },
      { skill: 'youtube.analyzer@1.0.0', score: '0.93', ok: true },
      { skill: 'google.drive@1.0.0', score: '0.89', ok: true },
      { skill: 'crisis-support@2.0.0', score: '0.61', ok: false },
    ];
    let fi = 0;

    function pushFeedEntry(item) {
      const f = document.getElementById('feedList');
      const d = new Date();
      const t = String(d.getHours()).padStart(2, '0') + ':' + String(d.getMinutes()).padStart(2, '0') + ':' + String(d.getSeconds()).padStart(2, '0');
      const el = document.createElement('div');
      el.className = 'fi';
      const liveLabel = item.live
        ? '<span style="font-family:var(--mono);font-size:9px;color:var(--green);background:var(--green-dim);border:1px solid rgba(57,255,136,0.2);padding:1px 5px;border-radius:2px;margin-left:4px">⚡LIVE</span>'
        : '';
      el.innerHTML = '<span class="fi-time">' + t + '</span>' +
        '<span class="fi-skill">' + item.skill + '</span>' +
        liveLabel +
        '<span class="fi-score">' + item.score + '</span>' +
        '<span class="' + (item.ok ? 'fi-ok' : 'fi-block') + '">' + (item.ok ? 'SAFE' : 'BLOCK') + '</span>';
      f.insertBefore(el, f.firstChild);
      if (f.children.length > 5) f.removeChild(f.lastChild);
    }

    function updateFeed() {
      const item = FEED_DATA[fi % FEED_DATA.length]; fi++;
      pushFeedEntry(item);
    }
    updateFeed();
    setInterval(updateFeed, 2600);

    // ── LIVE METRICS (simulated — no metrics API) ──
    let rCount = 48200 + Math.floor(Math.random() * 400);
    let sCount = 118 + Math.floor(Math.random() * 10);
    function updateMetrics() {
      rCount += Math.floor(Math.random() * 3) + 1;
      if (Math.random() > 0.92) sCount++;
      document.getElementById('mRouting').textContent = rCount.toLocaleString();
      document.getElementById('mSafety').textContent = sCount;
    }
    updateMetrics();
    setInterval(updateMetrics, 1100);

    // ── SCROLL REVEAL (with stagger) ──
    const revealObserver = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          e.target.classList.add('visible');
          revealObserver.unobserve(e.target);
        }
      });
    }, { threshold: 0.08, rootMargin: '0px 0px -40px 0px' });

    document.querySelectorAll('section:not(#hero)').forEach(s => {
      s.classList.add('reveal');
      revealObserver.observe(s);
    });
    // Stagger sibling cards
    const staggerGroups = ['.brand-card', '.sk-card', '.stage', '.conf-card', '.as-step', '.stat-card', '.cli-cmd', '.ms-card'];
    staggerGroups.forEach(sel => {
      document.querySelectorAll(sel).forEach((el, i) => {
        el.classList.add('reveal', 'reveal-d' + ((i % 4) + 1));
        revealObserver.observe(el);
      });
    });

    // ── NAV SCROLL EFFECTS ──
    const navEl = document.querySelector('nav');
    const navLinks = document.querySelectorAll('.nav-links a[href^="#"]');
    const sections = document.querySelectorAll('section[id]');

    window.addEventListener('scroll', () => {
      // Back to top
      const btn = document.getElementById('backToTop');
      if (window.scrollY > 400) btn.classList.add('show');
      else btn.classList.remove('show');
      // Nav background
      if (window.scrollY > 60) navEl.classList.add('scrolled');
      else navEl.classList.remove('scrolled');
      // Active section
      let current = '';
      sections.forEach(s => {
        const top = s.offsetTop - 120;
        if (window.scrollY >= top) current = s.getAttribute('id');
      });
      navLinks.forEach(a => {
        a.classList.remove('active');
        if (a.getAttribute('href') === '#' + current) a.classList.add('active');
      });
    }, { passive: true });

    // ── COPY TO CLIPBOARD ──
    document.querySelectorAll('.install-code').forEach(block => {
      const toast = document.createElement('span');
      toast.className = 'copy-toast';
      toast.textContent = '✓ copied';
      block.appendChild(toast);
      block.addEventListener('click', () => {
        const text = block.textContent.replace('✓ copied', '').trim();
        navigator.clipboard.writeText(text);
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 1500);
      });
    });

    // ── CURSOR GLOW ──
    (function () {
      const glow = document.createElement('div');
      glow.className = 'cursor-glow';
      document.body.appendChild(glow);
      let raf;
      document.addEventListener('mousemove', (e) => {
        if (raf) cancelAnimationFrame(raf);
        raf = requestAnimationFrame(() => {
          glow.style.left = e.clientX + 'px';
          glow.style.top = e.clientY + 'px';
          glow.classList.add('active');
        });
      }, { passive: true });
      document.addEventListener('mouseleave', () => glow.classList.remove('active'));
    })();

    // ── TYPING ANIMATION (playground) ──
    window._pickChipOrig = window.pickChip;
    window.pickChip = function (el, text) {
      _pickChipOrig(el, text);
      const input = document.getElementById('qinput');
      input.value = '';
      let i = 0;
      clearInterval(window._typeInterval);
      window._typeInterval = setInterval(() => {
        input.value += text[i];
        i++;
        if (i >= text.length) clearInterval(window._typeInterval);
      }, 30);
    };

    // ── PARTICLE CANVAS (optimized) ──
    (function () {
      const canvas = document.getElementById('particleCanvas');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      let particles = [];
      // Adaptive: fewer particles on mobile / low-end
      const isMobile = window.innerWidth < 768;
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const PARTICLE_COUNT = prefersReduced ? 0 : (isMobile ? 25 : 60);
      const CONNECT_DIST = isMobile ? 80 : 120;
      const colors = ['rgba(255,200,50,', 'rgba(57,255,136,', 'rgba(56,189,248,'];
      let isVisible = true;

      // IntersectionObserver to pause when hero off-screen
      const heroEl = document.getElementById('hero');
      const visObs = new IntersectionObserver(([entry]) => {
        isVisible = entry.isIntersecting;
      }, { threshold: 0 });
      visObs.observe(heroEl);

      function resize() {
        canvas.width = heroEl.offsetWidth;
        canvas.height = heroEl.offsetHeight;
      }

      function init() {
        resize();
        particles = [];
        for (let i = 0; i < PARTICLE_COUNT; i++) {
          particles.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            vx: (Math.random() - 0.5) * 0.4,
            vy: (Math.random() - 0.5) * 0.4,
            r: Math.random() * 2 + 1,
            color: colors[Math.floor(Math.random() * colors.length)]
          });
        }
      }

      function animate() {
        if (!isVisible) { requestAnimationFrame(animate); return; }
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < particles.length; i++) {
          const p = particles[i];
          p.x += p.vx; p.y += p.vy;
          if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
          if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fillStyle = p.color + '0.5)';
          ctx.fill();
          for (let j = i + 1; j < particles.length; j++) {
            const q = particles[j];
            const dx = p.x - q.x, dy = p.y - q.y;
            const dist = Math.sqrt(dx * dx + dy * dy);
            if (dist < CONNECT_DIST) {
              ctx.beginPath();
              ctx.moveTo(p.x, p.y);
              ctx.lineTo(q.x, q.y);
              ctx.strokeStyle = p.color + (0.15 * (1 - dist / CONNECT_DIST)).toFixed(2) + ')';
              ctx.lineWidth = 0.5;
              ctx.stroke();
            }
          }
        }
        requestAnimationFrame(animate);
      }

      if (PARTICLE_COUNT > 0) { init(); animate(); }
      window.addEventListener('resize', () => { resize(); });
    })();

    // ── COUNTER ANIMATION ──
    function animateCounter(el, target, suffix) {
      suffix = suffix || '';
      const duration = 2000;
      const start = performance.now();
      const startVal = 0;
      function update(now) {
        const progress = Math.min((now - start) / duration, 1);
        const ease = 1 - Math.pow(1 - progress, 3);
        const current = Math.floor(startVal + (target - startVal) * ease);
        el.textContent = current.toLocaleString() + suffix;
        if (progress < 1) requestAnimationFrame(update);
      }
      requestAnimationFrame(update);
    }

    const counterObserver = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          e.target.querySelectorAll('[data-count]').forEach(el => {
            const target = parseInt(el.getAttribute('data-count'));
            const suffix = el.getAttribute('data-suffix') || '';
            animateCounter(el, target, suffix);
          });
          counterObserver.unobserve(e.target);
        }
      });
    }, { threshold: 0.3 });

    const statusSection = document.getElementById('status');
    if (statusSection) counterObserver.observe(statusSection);
  </script>
</body>

</html>